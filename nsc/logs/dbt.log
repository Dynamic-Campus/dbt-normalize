

============================== 19:13:45.362505 | 2a78bd71-2d49-476c-9d01-eead8b92786e ==============================
[0m19:13:45.362505 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:13:45.364735 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:13:45.375752 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no longer be supported in a future version
of dbt-core. If you wish to write dbt artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m19:13:45.392921 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/dbt'
[0m19:13:45.393921 [error] [MainThread]: Traceback (most recent call last):
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 125, in wrapper
    return func(*args, **kwargs)
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 437, in deps
    results = task.run()
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/task/deps.py", line 57, in run
    system.make_directory(self.project.packages_install_path)
  File "/usr/lib/python3.10/functools.py", line 889, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/clients/system.py", line 128, in _
    raise e
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/clients/system.py", line 122, in _
    os.makedirs(path)
  File "/usr/lib/python3.10/os.py", line 225, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: '/dbt'

[0m19:13:45.394580 [debug] [MainThread]: Command `dbt deps` failed at 19:13:45.394474 after 0.04 seconds
[0m19:13:45.394839 [debug] [MainThread]: Flushing usage events


============================== 19:13:46.899153 | e038d3ec-188f-483a-99f8-048a1285f2bd ==============================
[0m19:13:46.899153 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:13:46.901410 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:13:46.944247 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no longer be supported in a future version
of dbt-core. If you wish to write dbt artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m19:13:46.973847 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in /dbt. Run "dbt deps" to install package dependencies.
[0m19:13:46.974522 [debug] [MainThread]: Command `dbt run` failed at 19:13:46.974415 after 0.08 seconds
[0m19:13:46.974791 [debug] [MainThread]: Flushing usage events


============================== 19:14:20.524874 | 0de1360e-7f7e-499d-8cd0-ff7023a10ca0 ==============================
[0m19:14:20.524874 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:14:20.527016 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'version_check': 'True', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:14:20.553519 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/dbt'
[0m19:14:20.554505 [error] [MainThread]: Traceback (most recent call last):
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 125, in wrapper
    return func(*args, **kwargs)
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 437, in deps
    results = task.run()
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/task/deps.py", line 57, in run
    system.make_directory(self.project.packages_install_path)
  File "/usr/lib/python3.10/functools.py", line 889, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/clients/system.py", line 128, in _
    raise e
  File "/home/azureuser/.local/lib/python3.10/site-packages/dbt/clients/system.py", line 122, in _
    os.makedirs(path)
  File "/usr/lib/python3.10/os.py", line 225, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: '/dbt'

[0m19:14:20.555150 [debug] [MainThread]: Command `dbt deps` failed at 19:14:20.555045 after 0.04 seconds
[0m19:14:20.555425 [debug] [MainThread]: Flushing usage events


============================== 19:14:22.028833 | d793e1bd-7a12-4e80-a70e-35ad44ec82a7 ==============================
[0m19:14:22.028833 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:14:22.031003 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:14:22.101642 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in /dbt. Run "dbt deps" to install package dependencies.
[0m19:14:22.102370 [debug] [MainThread]: Command `dbt run` failed at 19:14:22.102254 after 0.08 seconds
[0m19:14:22.102643 [debug] [MainThread]: Flushing usage events


============================== 19:14:49.486761 | 200003f2-962d-4231-971a-b4d02704dbfa ==============================
[0m19:14:49.486761 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:14:49.488930 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:14:49.521577 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q5zhjl9t'
[0m19:14:49.522121 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:14:50.109038 [debug] [MainThread]: STDOUT: "b''"
[0m19:14:50.109419 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m19:14:50.109770 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m19:14:50.109997 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:14:50.115145 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m19:14:50.115458 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.115672 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:14:50.115885 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:14:50.120710 [debug] [MainThread]: STDOUT: "b''"
[0m19:14:50.120935 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.121147 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:14:50.480924 [debug] [MainThread]: STDOUT: "b''"
[0m19:14:50.481447 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m19:14:50.481808 [debug] [MainThread]: Executing "git tag --list"
[0m19:14:50.483269 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:14:50.483547 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.483769 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:14:50.496356 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:14:50.496604 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.496824 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:14:50.497848 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:14:50.498076 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.498287 [debug] [MainThread]: Checked out at 5717b10.
[0m19:14:50.498974 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:14:50.500009 [debug] [MainThread]: STDOUT: "b''"
[0m19:14:50.500240 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:14:50.500442 [debug] [MainThread]: command return code=128
[0m19:14:50.501036 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:14:50.501257 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:14:50.502268 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:14:50.502496 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.502701 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:14:50.502907 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:14:50.504215 [debug] [MainThread]: STDOUT: "b''"
[0m19:14:50.504444 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.504661 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:14:50.735855 [debug] [MainThread]: STDOUT: "b''"
[0m19:14:50.736245 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:14:50.736488 [debug] [MainThread]: Executing "git tag --list"
[0m19:14:50.737959 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:14:50.738207 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.738428 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:14:50.746238 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:14:50.746531 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.746770 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:14:50.747817 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:14:50.748045 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.748254 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:14:50.748989 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m19:14:50.749384 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:14:50.750346 [debug] [MainThread]: STDOUT: "b''"
[0m19:14:50.750576 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:14:50.750788 [debug] [MainThread]: command return code=128
[0m19:14:50.751221 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:14:50.751528 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:14:50.752530 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:14:50.752754 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.752960 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:14:50.753162 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:14:50.754391 [debug] [MainThread]: STDOUT: "b''"
[0m19:14:50.754619 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.754834 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:14:50.955554 [debug] [MainThread]: STDOUT: "b''"
[0m19:14:50.955943 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:14:50.956184 [debug] [MainThread]: Executing "git tag --list"
[0m19:14:50.957642 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:14:50.957891 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.958113 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:14:50.965795 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:14:50.966107 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.966323 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:14:50.967333 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:14:50.967640 [debug] [MainThread]: STDERR: "b''"
[0m19:14:50.967846 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:14:50.968095 [info ] [MainThread]: Installed from revision 0.8.2
[0m19:14:50.968767 [debug] [MainThread]: Command `dbt deps` succeeded at 19:14:50.968659 after 1.49 seconds
[0m19:14:50.969018 [debug] [MainThread]: Flushing usage events


============================== 19:14:52.430381 | 9580feae-7e79-4596-a678-d9e5d96a187b ==============================
[0m19:14:52.430381 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:14:52.432644 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'fail_fast': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:14:52.522487 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m19:14:52.522997 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:14:53.509705 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab1.sql
[0m19:14:53.556120 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab1.sql
[0m19:14:53.559171 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab2.sql
[0m19:14:53.596645 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab2.sql
[0m19:14:53.599507 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab3.sql
[0m19:14:53.627406 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab3.sql
[0m19:14:53.629944 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_tables/public/nsc.sql
[0m19:14:53.645172 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_tables/public/nsc.sql
[0m19:14:53.751253 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_incremental
- models.airbyte_utils.generated.airbyte_views
[0m19:14:53.765720 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:14:53.767166 [info ] [MainThread]: 
[0m19:14:53.767962 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:53.769112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m19:14:53.779114 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m19:14:53.779438 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m19:14:53.779680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:53.858389 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:14:53.859703 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m19:14:53.861721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m19:14:53.867630 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:14:53.867902 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m19:14:53.868129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:53.876981 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:14:53.877258 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:14:53.877501 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:14:53.879696 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:14:53.880770 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m19:14:53.881374 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m19:14:53.887623 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:53.887886 [debug] [MainThread]: On master: BEGIN
[0m19:14:53.888104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:53.896564 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:53.896836 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:53.897143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:53.910347 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:14:53.911477 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:53.912160 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:53.912408 [debug] [MainThread]: On master: BEGIN
[0m19:14:53.913569 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:53.913833 [debug] [MainThread]: On master: COMMIT
[0m19:14:53.914082 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:53.914303 [debug] [MainThread]: On master: COMMIT
[0m19:14:53.914942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:53.915196 [debug] [MainThread]: On master: Close
[0m19:14:53.916121 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m19:14:53.916658 [info ] [MainThread]: 
[0m19:14:53.920709 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m19:14:53.921329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m19:14:53.921630 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m19:14:53.952870 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m19:14:53.954164 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 19:14:53.921817 => 19:14:53.953940
[0m19:14:53.954952 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m19:14:53.955702 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m19:14:53.956371 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m19:14:53.956660 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m19:14:54.002866 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m19:14:54.003539 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 19:14:53.956841 => 19:14:54.003295
[0m19:14:54.004337 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m19:14:54.005089 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m19:14:54.005791 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m19:14:54.006117 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m19:14:54.068978 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m19:14:54.069705 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 19:14:54.006327 => 19:14:54.069484
[0m19:14:54.070581 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m19:14:54.071388 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m19:14:54.071850 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m19:14:54.072653 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m19:14:54.072948 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m19:14:54.089658 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m19:14:54.090388 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 19:14:54.073127 => 19:14:54.090186
[0m19:14:54.090687 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m19:14:54.125896 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m19:14:54.127010 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:14:54.127406 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m19:14:54.127706 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:14:54.136321 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:54.136641 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:14:54.137204 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "NameSuffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("NameSuffix" as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "Name Suffix",
    "Degree CIP 4",
    "Degree CIP 2",
    "Degree CIP 3",
    "College Code/Branch",
    "First Name",
    "College Name",
    "Graduated?",
    "Degree Title",
    "Enrollment Major 2",
    "Degree CIP 1",
    "Enrollment Major 1",
    "Class Level",
    "Your Unique Identifier",
    "Search Date",
    "College State",
    "Middle Initial",
    "Enrollment Begin",
    "Enrollment Status",
    last_modified,
    "Enrollment CIP 2",
    "Enrollment CIP 1",
    "Degree Major 4",
    "Degree Major 3",
    "Graduation Date",
    "Degree Major 2",
    "Degree Major 1",
    "Public / Private",
    "Enrollment End",
    "Last Name",
    "2-year / 4-year",
    "Record Found Y/N",
    "College Sequence",
    "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m19:14:54.139118 [debug] [Thread-7 (]: Postgres adapter: Postgres error: column "Name Suffix" does not exist
LINE 138:     "Name Suffix",
              ^
HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.NameSuffix".

[0m19:14:54.139469 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: ROLLBACK
[0m19:14:54.140257 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 19:14:54.090869 => 19:14:54.140047
[0m19:14:54.140559 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m19:14:54.161249 [debug] [Thread-7 (]: Database Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)
  column "Name Suffix" does not exist
  LINE 138:     "Name Suffix",
                ^
  HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.NameSuffix".
  compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:14:54.161851 [error] [Thread-7 (]: 1 of 1 ERROR creating sql table model public.nsc ....................................................................... [[31mERROR[0m in 0.09s]
[0m19:14:54.162353 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m19:14:54.163957 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:54.164215 [debug] [MainThread]: On master: BEGIN
[0m19:14:54.164434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:54.174430 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:54.174708 [debug] [MainThread]: On master: COMMIT
[0m19:14:54.174944 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:54.175165 [debug] [MainThread]: On master: COMMIT
[0m19:14:54.175893 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:54.176154 [debug] [MainThread]: On master: Close
[0m19:14:54.176783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:54.177119 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m19:14:54.177414 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m19:14:54.177697 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m19:14:54.177971 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m19:14:54.178234 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m19:14:54.178551 [info ] [MainThread]: 
[0m19:14:54.178912 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m19:14:54.179458 [debug] [MainThread]: Command end result
[0m19:14:54.188559 [info ] [MainThread]: 
[0m19:14:54.188959 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:14:54.189298 [info ] [MainThread]: 
[0m19:14:54.189618 [error] [MainThread]: [33mDatabase Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)[0m
[0m19:14:54.189948 [error] [MainThread]:   column "Name Suffix" does not exist
[0m19:14:54.190251 [error] [MainThread]:   LINE 138:     "Name Suffix",
[0m19:14:54.190550 [error] [MainThread]:                 ^
[0m19:14:54.190842 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.NameSuffix".
[0m19:14:54.191139 [error] [MainThread]:   compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:14:54.191468 [info ] [MainThread]: 
[0m19:14:54.191792 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:14:54.192324 [debug] [MainThread]: Command `dbt run` failed at 19:14:54.192225 after 1.77 seconds
[0m19:14:54.192599 [debug] [MainThread]: Flushing usage events


============================== 19:19:36.591096 | ff75de68-945b-4f00-bea3-706257ff0ea4 ==============================
[0m19:19:36.591096 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:19:36.593318 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:19:36.620110 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-czpaecko'
[0m19:19:36.620642 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:19:36.947635 [debug] [MainThread]: STDOUT: "b''"
[0m19:19:36.948069 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m19:19:36.948442 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m19:19:36.948674 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:19:36.949828 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m19:19:36.950060 [debug] [MainThread]: STDERR: "b''"
[0m19:19:36.950268 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:19:36.950483 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:19:36.951866 [debug] [MainThread]: STDOUT: "b''"
[0m19:19:36.952099 [debug] [MainThread]: STDERR: "b''"
[0m19:19:36.952314 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:19:37.251008 [debug] [MainThread]: STDOUT: "b''"
[0m19:19:37.251576 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m19:19:37.251940 [debug] [MainThread]: Executing "git tag --list"
[0m19:19:37.253471 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:19:37.253720 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.253941 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:19:37.266919 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:19:37.267264 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.267540 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:19:37.268745 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:19:37.268973 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.269187 [debug] [MainThread]: Checked out at 5717b10.
[0m19:19:37.269904 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:19:37.270968 [debug] [MainThread]: STDOUT: "b''"
[0m19:19:37.271200 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:19:37.271454 [debug] [MainThread]: command return code=128
[0m19:19:37.272056 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:19:37.272282 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:19:37.273330 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:19:37.273578 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.273784 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:19:37.273998 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:19:37.275310 [debug] [MainThread]: STDOUT: "b''"
[0m19:19:37.275575 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.275794 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:19:37.511772 [debug] [MainThread]: STDOUT: "b''"
[0m19:19:37.512169 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:19:37.512410 [debug] [MainThread]: Executing "git tag --list"
[0m19:19:37.513944 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:19:37.514198 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.514426 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:19:37.521746 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:19:37.522036 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.522296 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:19:37.523329 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:19:37.523582 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.523791 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:19:37.524524 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m19:19:37.530239 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:19:37.531250 [debug] [MainThread]: STDOUT: "b''"
[0m19:19:37.531638 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:19:37.531843 [debug] [MainThread]: command return code=128
[0m19:19:37.532273 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:19:37.532480 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:19:37.533490 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:19:37.533714 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.533915 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:19:37.534121 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:19:37.535374 [debug] [MainThread]: STDOUT: "b''"
[0m19:19:37.535651 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.535867 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:19:37.735966 [debug] [MainThread]: STDOUT: "b''"
[0m19:19:37.736363 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:19:37.736602 [debug] [MainThread]: Executing "git tag --list"
[0m19:19:37.738067 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:19:37.738314 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.738530 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:19:37.745569 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:19:37.745856 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.746075 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:19:37.747118 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:19:37.747371 [debug] [MainThread]: STDERR: "b''"
[0m19:19:37.747592 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:19:37.747833 [info ] [MainThread]: Installed from revision 0.8.2
[0m19:19:37.748509 [debug] [MainThread]: Command `dbt deps` succeeded at 19:19:37.748402 after 1.16 seconds
[0m19:19:37.748762 [debug] [MainThread]: Flushing usage events


============================== 19:19:39.242165 | f385bb81-912a-458a-ad55-4ad57327e496 ==============================
[0m19:19:39.242165 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:19:39.244437 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:19:39.331691 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m19:19:39.384091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:19:39.384624 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_tables/public/nsc.sql
[0m19:19:39.406460 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_tables/public/nsc.sql
[0m19:19:39.430584 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_tables/public/nsc.sql
[0m19:19:39.438511 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_views
- models.airbyte_utils.generated.airbyte_incremental
[0m19:19:39.452259 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:19:39.453631 [info ] [MainThread]: 
[0m19:19:39.454357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:19:39.455334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m19:19:39.465109 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m19:19:39.465396 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m19:19:39.465630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:39.478836 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:19:39.479950 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m19:19:39.482299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m19:19:39.487896 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:19:39.488165 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m19:19:39.488398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:39.497575 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:19:39.497862 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:19:39.498114 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:19:39.500317 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:19:39.501398 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m19:19:39.502090 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m19:19:39.507674 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:39.507949 [debug] [MainThread]: On master: BEGIN
[0m19:19:39.508170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:39.517471 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:39.517761 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:39.518065 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:19:39.524887 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:19:39.525892 [debug] [MainThread]: On master: ROLLBACK
[0m19:19:39.526511 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:39.526760 [debug] [MainThread]: On master: BEGIN
[0m19:19:39.527748 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:39.528018 [debug] [MainThread]: On master: COMMIT
[0m19:19:39.528246 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:39.528460 [debug] [MainThread]: On master: COMMIT
[0m19:19:39.529044 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:19:39.529298 [debug] [MainThread]: On master: Close
[0m19:19:39.530229 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m19:19:39.530777 [info ] [MainThread]: 
[0m19:19:39.534147 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m19:19:39.534756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m19:19:39.535052 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m19:19:39.570789 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m19:19:39.571520 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 19:19:39.535236 => 19:19:39.571272
[0m19:19:39.572303 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m19:19:39.573035 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m19:19:39.573713 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m19:19:39.573998 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m19:19:39.628792 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m19:19:39.629531 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 19:19:39.574174 => 19:19:39.629307
[0m19:19:39.630367 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m19:19:39.631143 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m19:19:39.631854 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m19:19:39.632146 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m19:19:39.703732 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m19:19:39.704433 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 19:19:39.632329 => 19:19:39.704230
[0m19:19:39.705254 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m19:19:39.706025 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m19:19:39.706475 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m19:19:39.707261 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m19:19:39.707592 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m19:19:39.723974 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m19:19:39.724509 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 19:19:39.707771 => 19:19:39.724303
[0m19:19:39.724810 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m19:19:39.759047 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m19:19:39.759631 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:19:39.759934 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m19:19:39.760206 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:19:39.769719 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:39.770037 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:19:39.770609 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "NameSuffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("NameSuffix" as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "NameSuffix",
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "Degree Major4",
    "Degree Major3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "Record FoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m19:19:39.772728 [debug] [Thread-7 (]: Postgres adapter: Postgres error: column "Degree Major4" does not exist
LINE 160:     "Degree Major4",
              ^
HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.DegreeMajor4".

[0m19:19:39.773048 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: ROLLBACK
[0m19:19:39.773971 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 19:19:39.724992 => 19:19:39.773765
[0m19:19:39.774274 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m19:19:39.776582 [debug] [Thread-7 (]: Database Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)
  column "Degree Major4" does not exist
  LINE 160:     "Degree Major4",
                ^
  HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.DegreeMajor4".
  compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:19:39.777152 [error] [Thread-7 (]: 1 of 1 ERROR creating sql table model public.nsc ....................................................................... [[31mERROR[0m in 0.07s]
[0m19:19:39.777638 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m19:19:39.779101 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:39.779472 [debug] [MainThread]: On master: BEGIN
[0m19:19:39.779730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:39.788420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:39.788692 [debug] [MainThread]: On master: COMMIT
[0m19:19:39.788924 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:39.789140 [debug] [MainThread]: On master: COMMIT
[0m19:19:39.789819 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:19:39.790072 [debug] [MainThread]: On master: Close
[0m19:19:39.790740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:39.791105 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m19:19:39.791446 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m19:19:39.791735 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m19:19:39.792002 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m19:19:39.792280 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m19:19:39.792534 [info ] [MainThread]: 
[0m19:19:39.792882 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m19:19:39.793383 [debug] [MainThread]: Command end result
[0m19:19:39.801963 [info ] [MainThread]: 
[0m19:19:39.802349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:19:39.802670 [info ] [MainThread]: 
[0m19:19:39.802982 [error] [MainThread]: [33mDatabase Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)[0m
[0m19:19:39.803295 [error] [MainThread]:   column "Degree Major4" does not exist
[0m19:19:39.803624 [error] [MainThread]:   LINE 160:     "Degree Major4",
[0m19:19:39.803916 [error] [MainThread]:                 ^
[0m19:19:39.804207 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.DegreeMajor4".
[0m19:19:39.804489 [error] [MainThread]:   compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:19:39.804772 [info ] [MainThread]: 
[0m19:19:39.805084 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:19:39.805607 [debug] [MainThread]: Command `dbt run` failed at 19:19:39.805510 after 0.57 seconds
[0m19:19:39.805882 [debug] [MainThread]: Flushing usage events


============================== 19:20:24.866073 | f600f6dc-b2ba-43c5-a6df-8b9ff5a3a067 ==============================
[0m19:20:24.866073 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:20:24.868318 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:20:24.895609 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q0bh0ys1'
[0m19:20:24.896178 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:20:25.139400 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:25.139818 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m19:20:25.140184 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m19:20:25.140420 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:25.141585 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m19:20:25.141820 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.142035 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:20:25.142255 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:20:25.143644 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:25.143874 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.144091 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:20:25.465118 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:25.465616 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m19:20:25.465960 [debug] [MainThread]: Executing "git tag --list"
[0m19:20:25.467451 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:20:25.467702 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.467923 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:20:25.480496 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:20:25.480752 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.480997 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:25.482533 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:20:25.482772 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.482988 [debug] [MainThread]: Checked out at 5717b10.
[0m19:20:25.483759 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:20:25.484746 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:25.484979 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:20:25.485184 [debug] [MainThread]: command return code=128
[0m19:20:25.485784 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:20:25.486005 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:25.487019 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:20:25.487247 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.487529 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:20:25.487747 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:20:25.488967 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:25.489193 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.489406 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:20:25.688693 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:25.689086 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:20:25.689327 [debug] [MainThread]: Executing "git tag --list"
[0m19:20:25.690800 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:20:25.691049 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.691271 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:20:25.699254 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:20:25.699541 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.699759 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:25.700792 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:20:25.701019 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.701228 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:20:25.701967 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m19:20:25.707745 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:20:25.708821 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:25.709053 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:20:25.709255 [debug] [MainThread]: command return code=128
[0m19:20:25.709688 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:20:25.709900 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:25.710913 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:20:25.711144 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.711372 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:20:25.711592 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:20:25.713142 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:25.713372 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.713585 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:20:25.937546 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:25.937947 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:20:25.938186 [debug] [MainThread]: Executing "git tag --list"
[0m19:20:25.939692 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:20:25.939943 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.940166 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:20:25.963078 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:20:25.963491 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.963727 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:25.964940 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:20:25.965169 [debug] [MainThread]: STDERR: "b''"
[0m19:20:25.965378 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:20:25.965632 [info ] [MainThread]: Installed from revision 0.8.2
[0m19:20:25.966305 [debug] [MainThread]: Command `dbt deps` succeeded at 19:20:25.966200 after 1.11 seconds
[0m19:20:25.966565 [debug] [MainThread]: Flushing usage events


============================== 19:20:27.469898 | 7de03b8b-419c-426e-b96f-ca916c0c4118 ==============================
[0m19:20:27.469898 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:20:27.472225 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'fail_fast': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:20:27.560541 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m19:20:27.616409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:20:27.616955 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_tables/public/nsc.sql
[0m19:20:27.639151 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_tables/public/nsc.sql
[0m19:20:27.662977 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_tables/public/nsc.sql
[0m19:20:27.670774 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_views
- models.airbyte_utils.generated.airbyte_incremental
[0m19:20:27.684336 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:20:27.685781 [info ] [MainThread]: 
[0m19:20:27.686513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:20:27.687467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m19:20:27.697721 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m19:20:27.698002 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m19:20:27.698236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:27.708271 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:20:27.709318 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m19:20:27.710615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datahub_staging, now list_datahub_staging_public)
[0m19:20:27.715874 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:20:27.716146 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m19:20:27.716369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:27.725789 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:20:27.726094 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:20:27.726346 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:20:27.728782 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:20:27.729851 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m19:20:27.730798 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m19:20:27.736883 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:27.737160 [debug] [MainThread]: On master: BEGIN
[0m19:20:27.737381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:27.746156 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:20:27.746446 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:27.746752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:20:27.753564 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:20:27.754591 [debug] [MainThread]: On master: ROLLBACK
[0m19:20:27.755302 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:27.755591 [debug] [MainThread]: On master: BEGIN
[0m19:20:27.756641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:20:27.756911 [debug] [MainThread]: On master: COMMIT
[0m19:20:27.757137 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:27.757354 [debug] [MainThread]: On master: COMMIT
[0m19:20:27.757950 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:20:27.758203 [debug] [MainThread]: On master: Close
[0m19:20:27.759107 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m19:20:27.759580 [info ] [MainThread]: 
[0m19:20:27.763214 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m19:20:27.763848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m19:20:27.764148 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m19:20:27.800165 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m19:20:27.800963 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 19:20:27.764335 => 19:20:27.800690
[0m19:20:27.801799 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m19:20:27.802591 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m19:20:27.803277 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m19:20:27.803600 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m19:20:27.860017 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m19:20:27.860849 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 19:20:27.803778 => 19:20:27.860583
[0m19:20:27.861776 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m19:20:27.862651 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m19:20:27.863418 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m19:20:27.863732 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m19:20:27.936859 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m19:20:27.937756 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 19:20:27.863914 => 19:20:27.937442
[0m19:20:27.938689 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m19:20:27.939549 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m19:20:27.940006 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m19:20:27.940827 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m19:20:27.941125 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m19:20:27.957863 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m19:20:27.958521 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 19:20:27.941304 => 19:20:27.958275
[0m19:20:27.958823 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m19:20:27.993620 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m19:20:27.994220 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:20:27.994533 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m19:20:27.994825 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:20:28.004084 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m19:20:28.004486 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:20:28.005065 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "NameSuffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("NameSuffix" as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "NameSuffix",
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "DegreeMajor4",
    "DegreeMajor3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "Record FoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m19:20:28.007221 [debug] [Thread-7 (]: Postgres adapter: Postgres error: column "Record FoundYN" does not exist
LINE 169:     "Record FoundYN",
              ^
HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.RecordFoundYN".

[0m19:20:28.007574 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: ROLLBACK
[0m19:20:28.008401 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 19:20:27.959005 => 19:20:28.008192
[0m19:20:28.008712 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m19:20:28.011157 [debug] [Thread-7 (]: Database Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)
  column "Record FoundYN" does not exist
  LINE 169:     "Record FoundYN",
                ^
  HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.RecordFoundYN".
  compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:20:28.011790 [error] [Thread-7 (]: 1 of 1 ERROR creating sql table model public.nsc ....................................................................... [[31mERROR[0m in 0.07s]
[0m19:20:28.012290 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m19:20:28.013919 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:28.014179 [debug] [MainThread]: On master: BEGIN
[0m19:20:28.014398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:28.022878 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:20:28.023174 [debug] [MainThread]: On master: COMMIT
[0m19:20:28.023439 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:28.023669 [debug] [MainThread]: On master: COMMIT
[0m19:20:28.024267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:20:28.024520 [debug] [MainThread]: On master: Close
[0m19:20:28.025357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:28.025696 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m19:20:28.025982 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m19:20:28.026245 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m19:20:28.026609 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m19:20:28.026876 [info ] [MainThread]: 
[0m19:20:28.027232 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m19:20:28.027783 [debug] [MainThread]: Command end result
[0m19:20:28.036653 [info ] [MainThread]: 
[0m19:20:28.037059 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:20:28.037386 [info ] [MainThread]: 
[0m19:20:28.037709 [error] [MainThread]: [33mDatabase Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)[0m
[0m19:20:28.038026 [error] [MainThread]:   column "Record FoundYN" does not exist
[0m19:20:28.038332 [error] [MainThread]:   LINE 169:     "Record FoundYN",
[0m19:20:28.038629 [error] [MainThread]:                 ^
[0m19:20:28.038927 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.RecordFoundYN".
[0m19:20:28.039213 [error] [MainThread]:   compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:20:28.039526 [info ] [MainThread]: 
[0m19:20:28.039846 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:20:28.040426 [debug] [MainThread]: Command `dbt run` failed at 19:20:28.040326 after 0.58 seconds
[0m19:20:28.040702 [debug] [MainThread]: Flushing usage events


============================== 19:20:42.912947 | 485eeba9-9a39-493b-a4b5-ee0863c045dd ==============================
[0m19:20:42.912947 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:20:42.915153 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:20:42.941916 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c__wbnc4'
[0m19:20:42.942347 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:20:43.161967 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:43.162362 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m19:20:43.162723 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m19:20:43.162953 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:43.164111 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m19:20:43.164347 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.164559 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:20:43.164778 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:20:43.166073 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:43.166302 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.166516 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:20:43.464809 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:43.465319 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m19:20:43.465673 [debug] [MainThread]: Executing "git tag --list"
[0m19:20:43.467149 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:20:43.467436 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.467670 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:20:43.478341 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:20:43.478613 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.478836 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:43.479877 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:20:43.480112 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.480333 [debug] [MainThread]: Checked out at 5717b10.
[0m19:20:43.481046 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:20:43.482024 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:43.482257 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:20:43.482463 [debug] [MainThread]: command return code=128
[0m19:20:43.483061 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:20:43.483287 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:43.484381 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:20:43.484611 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.484826 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:20:43.485037 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:20:43.486267 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:43.486496 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.486713 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:20:43.712902 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:43.713295 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:20:43.713538 [debug] [MainThread]: Executing "git tag --list"
[0m19:20:43.715007 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:20:43.715256 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.715514 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:20:43.723160 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:20:43.723503 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.723776 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:43.724862 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:20:43.725094 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.725305 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:20:43.726048 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m19:20:43.731045 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:20:43.732150 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:43.732388 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:20:43.732599 [debug] [MainThread]: command return code=128
[0m19:20:43.733032 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:20:43.733244 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:43.734252 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:20:43.734481 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.734688 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:20:43.734900 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:20:43.736136 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:43.736366 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.736583 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:20:43.943865 [debug] [MainThread]: STDOUT: "b''"
[0m19:20:43.944264 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:20:43.944515 [debug] [MainThread]: Executing "git tag --list"
[0m19:20:43.945955 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:20:43.946208 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.946437 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:20:43.954000 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:20:43.954295 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.954539 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:20:43.955568 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:20:43.955799 [debug] [MainThread]: STDERR: "b''"
[0m19:20:43.956012 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:20:43.956258 [info ] [MainThread]: Installed from revision 0.8.2
[0m19:20:43.956963 [debug] [MainThread]: Command `dbt deps` succeeded at 19:20:43.956857 after 1.05 seconds
[0m19:20:43.957218 [debug] [MainThread]: Flushing usage events


============================== 19:20:45.432248 | a4ed4365-b8dd-454d-be59-5122ba2ecdc3 ==============================
[0m19:20:45.432248 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:20:45.434520 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:20:45.521525 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m19:20:45.575624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:20:45.576147 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_tables/public/nsc.sql
[0m19:20:45.598490 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_tables/public/nsc.sql
[0m19:20:45.622550 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_tables/public/nsc.sql
[0m19:20:45.630351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_incremental
- models.airbyte_utils.generated.airbyte_views
[0m19:20:45.643919 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:20:45.645336 [info ] [MainThread]: 
[0m19:20:45.646088 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:20:45.647032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m19:20:45.656789 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m19:20:45.657083 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m19:20:45.657330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:45.667237 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:20:45.668328 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m19:20:45.670161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datahub_staging, now list_datahub_staging_public)
[0m19:20:45.675749 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:20:45.676024 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m19:20:45.676252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:45.684822 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:20:45.685092 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:20:45.685341 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:20:45.687438 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:20:45.688475 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m19:20:45.689083 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m19:20:45.694397 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:45.694659 [debug] [MainThread]: On master: BEGIN
[0m19:20:45.694908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:45.703460 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:20:45.703738 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:45.704039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:20:45.710716 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:20:45.711709 [debug] [MainThread]: On master: ROLLBACK
[0m19:20:45.712946 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:45.713195 [debug] [MainThread]: On master: BEGIN
[0m19:20:45.717377 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:20:45.717639 [debug] [MainThread]: On master: COMMIT
[0m19:20:45.717869 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:45.718136 [debug] [MainThread]: On master: COMMIT
[0m19:20:45.719015 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:20:45.719310 [debug] [MainThread]: On master: Close
[0m19:20:45.720178 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m19:20:45.720737 [info ] [MainThread]: 
[0m19:20:45.724182 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m19:20:45.724790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m19:20:45.725088 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m19:20:45.762614 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m19:20:45.763310 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 19:20:45.725270 => 19:20:45.763082
[0m19:20:45.764151 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m19:20:45.764891 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m19:20:45.765551 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m19:20:45.765842 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m19:20:45.822620 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m19:20:45.823413 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 19:20:45.766021 => 19:20:45.823140
[0m19:20:45.824257 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m19:20:45.825016 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m19:20:45.825712 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m19:20:45.826008 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m19:20:45.898399 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m19:20:45.899294 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 19:20:45.826187 => 19:20:45.899022
[0m19:20:45.900273 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m19:20:45.901139 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m19:20:45.901610 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m19:20:45.902439 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m19:20:45.902740 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m19:20:45.919823 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m19:20:45.920471 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 19:20:45.902923 => 19:20:45.920238
[0m19:20:45.920780 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m19:20:45.956684 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m19:20:45.957317 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:20:45.957648 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m19:20:45.957922 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:20:45.967251 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m19:20:45.967638 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:20:45.968209 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "NameSuffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("NameSuffix" as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "NameSuffix",
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "DegreeMajor4",
    "DegreeMajor3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "RecordFoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m19:20:49.302754 [debug] [Thread-7 (]: SQL status: SELECT 197245 in 3.0 seconds
[0m19:20:49.309260 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:20:49.309595 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging"."public"."nsc" rename to "nsc__dbt_backup"
[0m19:20:49.310478 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:20:49.313489 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:20:49.313790 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging".public."nsc__dbt_tmp" rename to "nsc"
[0m19:20:49.314654 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:20:49.325095 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:20:49.325416 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

    create  index if not exists
  "1bb4b587c12676ca2301ad2fca7cc9b6"
  on "datahub_staging".public."nsc" using btree
  (_airbyte_emitted_at);
  
[0m19:20:49.415685 [debug] [Thread-7 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:20:49.433868 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m19:20:49.434266 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:20:49.434546 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m19:20:49.438581 [debug] [Thread-7 (]: SQL status: COMMIT in 0.0 seconds
[0m19:20:49.443862 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:20:49.444184 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
drop table if exists "datahub_staging".public."nsc__dbt_backup" cascade
[0m19:20:49.453630 [debug] [Thread-7 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:20:49.455007 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 19:20:45.920966 => 19:20:49.454817
[0m19:20:49.455370 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m19:20:49.456564 [info ] [Thread-7 (]: 1 of 1 OK created sql table model public.nsc ........................................................................... [[32mSELECT 197245[0m in 3.55s]
[0m19:20:49.457374 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m19:20:49.459389 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:49.459745 [debug] [MainThread]: On master: BEGIN
[0m19:20:49.460026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:49.470503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:20:49.470901 [debug] [MainThread]: On master: COMMIT
[0m19:20:49.471202 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:49.471521 [debug] [MainThread]: On master: COMMIT
[0m19:20:49.472305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:20:49.472628 [debug] [MainThread]: On master: Close
[0m19:20:49.473481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:49.473773 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m19:20:49.474031 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m19:20:49.474282 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m19:20:49.474539 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m19:20:49.474856 [info ] [MainThread]: 
[0m19:20:49.475272 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m19:20:49.477817 [debug] [MainThread]: Command end result
[0m19:20:49.490938 [info ] [MainThread]: 
[0m19:20:49.491523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:49.491873 [info ] [MainThread]: 
[0m19:20:49.492227 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:20:49.492794 [debug] [MainThread]: Command `dbt run` succeeded at 19:20:49.492689 after 4.07 seconds
[0m19:20:49.493083 [debug] [MainThread]: Flushing usage events


============================== 19:30:06.409413 | e364b5a1-de50-4981-bbad-7ba23d9fc7b8 ==============================
[0m19:30:06.409413 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:30:06.412475 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'version_check': 'True', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:30:06.451958 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r_qoetfu'
[0m19:30:06.452575 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:30:06.834507 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:06.834921 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m19:30:06.835314 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m19:30:06.835599 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:06.836940 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m19:30:06.837179 [debug] [MainThread]: STDERR: "b''"
[0m19:30:06.837398 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:30:06.837630 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:30:06.839130 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:06.839390 [debug] [MainThread]: STDERR: "b''"
[0m19:30:06.839624 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:30:07.156645 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:07.157150 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m19:30:07.157495 [debug] [MainThread]: Executing "git tag --list"
[0m19:30:07.158980 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:30:07.159225 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.159490 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:30:07.172807 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:30:07.173044 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.173269 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:07.174292 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:30:07.174517 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.174726 [debug] [MainThread]: Checked out at 5717b10.
[0m19:30:07.175435 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:30:07.176408 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:07.176633 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:30:07.176836 [debug] [MainThread]: command return code=128
[0m19:30:07.177447 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:30:07.177670 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:07.178856 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:30:07.179215 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.179595 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:30:07.179832 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:30:07.181077 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:07.181297 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.181507 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:30:07.382796 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:07.383177 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:30:07.383436 [debug] [MainThread]: Executing "git tag --list"
[0m19:30:07.384933 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:30:07.385180 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.385400 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:30:07.395840 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:30:07.396127 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.396379 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:07.397393 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:30:07.397618 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.397831 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:30:07.398567 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m19:30:07.404401 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:30:07.405388 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:07.405621 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:30:07.405826 [debug] [MainThread]: command return code=128
[0m19:30:07.406263 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:30:07.406471 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:07.407481 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:30:07.407711 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.407920 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:30:07.408127 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:30:07.409365 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:07.409586 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.409797 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:30:07.629756 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:07.630143 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:30:07.630381 [debug] [MainThread]: Executing "git tag --list"
[0m19:30:07.631879 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:30:07.632161 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.632413 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:30:07.640558 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:30:07.640795 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.641011 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:07.642024 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:30:07.642249 [debug] [MainThread]: STDERR: "b''"
[0m19:30:07.642474 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:30:07.642722 [info ] [MainThread]: Installed from revision 0.8.2
[0m19:30:07.643459 [debug] [MainThread]: Command `dbt deps` succeeded at 19:30:07.643326 after 1.24 seconds
[0m19:30:07.643719 [debug] [MainThread]: Flushing usage events


============================== 19:30:09.109697 | 32ef72be-756e-4f96-b3f6-ffa3263d9771 ==============================
[0m19:30:09.109697 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:30:09.111894 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'version_check': 'True', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:30:09.199219 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m19:30:09.250684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:30:09.251023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:30:09.251519 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_views
- models.airbyte_utils.generated.airbyte_incremental
[0m19:30:09.266933 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:30:09.268280 [info ] [MainThread]: 
[0m19:30:09.269018 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:09.269943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m19:30:09.279589 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m19:30:09.279868 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m19:30:09.280104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:09.290332 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:30:09.291398 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m19:30:09.293075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m19:30:09.298545 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:30:09.298818 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m19:30:09.299045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:09.309758 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:09.310055 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:30:09.310309 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:30:09.312433 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:30:09.313632 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m19:30:09.314251 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m19:30:09.319906 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:09.320185 [debug] [MainThread]: On master: BEGIN
[0m19:30:09.320413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:09.329076 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:09.329366 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:09.329675 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:09.336547 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:30:09.337623 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:09.338271 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:09.338524 [debug] [MainThread]: On master: BEGIN
[0m19:30:09.339493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:09.339779 [debug] [MainThread]: On master: COMMIT
[0m19:30:09.340014 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:09.340233 [debug] [MainThread]: On master: COMMIT
[0m19:30:09.340819 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:09.341074 [debug] [MainThread]: On master: Close
[0m19:30:09.341979 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m19:30:09.342521 [info ] [MainThread]: 
[0m19:30:09.346712 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m19:30:09.347318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m19:30:09.347663 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m19:30:09.383641 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m19:30:09.384247 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 19:30:09.347851 => 19:30:09.384009
[0m19:30:09.384996 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m19:30:09.385710 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m19:30:09.386369 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m19:30:09.386656 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m19:30:09.443298 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m19:30:09.444071 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 19:30:09.386832 => 19:30:09.443821
[0m19:30:09.444887 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m19:30:09.445661 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m19:30:09.446337 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m19:30:09.446638 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m19:30:09.517203 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m19:30:09.517955 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 19:30:09.446819 => 19:30:09.517705
[0m19:30:09.518762 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m19:30:09.519491 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m19:30:09.520014 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m19:30:09.520782 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m19:30:09.521080 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m19:30:09.538651 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m19:30:09.539223 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 19:30:09.521262 => 19:30:09.538991
[0m19:30:09.539578 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m19:30:09.573061 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m19:30:09.573664 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:30:09.573967 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m19:30:09.574241 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:30:09.581624 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:09.581942 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:30:09.582521 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "NameSuffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("NameSuffix" as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "NameSuffix",
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "DegreeMajor4",
    "DegreeMajor3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "RecordFoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m19:30:12.915169 [debug] [Thread-7 (]: SQL status: SELECT 197245 in 3.0 seconds
[0m19:30:12.921582 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:30:12.921913 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging"."public"."nsc" rename to "nsc__dbt_backup"
[0m19:30:12.922646 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:12.925481 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:30:12.925790 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging".public."nsc__dbt_tmp" rename to "nsc"
[0m19:30:12.926393 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:12.937215 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:30:12.937548 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

    create  index if not exists
  "1a9bcd9137d7f32fda4072c690fca973"
  on "datahub_staging".public."nsc" using btree
  (_airbyte_emitted_at);
  
[0m19:30:13.026792 [debug] [Thread-7 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:30:13.046481 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m19:30:13.046902 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:30:13.047194 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m19:30:13.051144 [debug] [Thread-7 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:13.056595 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:30:13.056919 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
drop table if exists "datahub_staging".public."nsc__dbt_backup" cascade
[0m19:30:13.066408 [debug] [Thread-7 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:30:13.067972 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 19:30:09.539770 => 19:30:13.067774
[0m19:30:13.068295 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m19:30:13.069496 [info ] [Thread-7 (]: 1 of 1 OK created sql table model public.nsc ........................................................................... [[32mSELECT 197245[0m in 3.55s]
[0m19:30:13.070317 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m19:30:13.072281 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:13.072604 [debug] [MainThread]: On master: BEGIN
[0m19:30:13.072884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:13.081703 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:13.082011 [debug] [MainThread]: On master: COMMIT
[0m19:30:13.082249 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:13.082489 [debug] [MainThread]: On master: COMMIT
[0m19:30:13.083062 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:13.083320 [debug] [MainThread]: On master: Close
[0m19:30:13.084201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:13.084546 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m19:30:13.084842 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m19:30:13.085123 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m19:30:13.085402 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m19:30:13.085605 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m19:30:13.085856 [info ] [MainThread]: 
[0m19:30:13.086208 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m19:30:13.086830 [debug] [MainThread]: Command end result
[0m19:30:13.095589 [info ] [MainThread]: 
[0m19:30:13.095989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:13.096318 [info ] [MainThread]: 
[0m19:30:13.096664 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:30:13.097224 [debug] [MainThread]: Command `dbt run` succeeded at 19:30:13.097122 after 3.99 seconds
[0m19:30:13.097488 [debug] [MainThread]: Flushing usage events


============================== 19:30:48.859135 | bcd42144-261a-4448-8737-0cf330fdaeb9 ==============================
[0m19:30:48.859135 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:30:48.861407 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:30:48.888212 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r672lt6x'
[0m19:30:48.888738 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:30:49.113222 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:49.113617 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m19:30:49.113970 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m19:30:49.114205 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:49.115329 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m19:30:49.115612 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.115827 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:30:49.116046 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:30:49.117320 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:49.117549 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.117768 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:30:49.432318 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:49.432950 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m19:30:49.433361 [debug] [MainThread]: Executing "git tag --list"
[0m19:30:49.434950 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:30:49.435204 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.435510 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:30:49.447236 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:30:49.447630 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.447866 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:49.448966 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:30:49.449198 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.449433 [debug] [MainThread]: Checked out at 5717b10.
[0m19:30:49.450234 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:30:49.451302 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:49.451567 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:30:49.451773 [debug] [MainThread]: command return code=128
[0m19:30:49.452369 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:30:49.452591 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:49.453617 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:30:49.453883 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.454116 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:30:49.454347 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:30:49.455856 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:49.456091 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.456390 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:30:49.708924 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:49.709317 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:30:49.709556 [debug] [MainThread]: Executing "git tag --list"
[0m19:30:49.711028 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:30:49.711279 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.711530 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:30:49.719155 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:30:49.719498 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.719728 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:49.720742 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:30:49.720969 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.721175 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:30:49.721909 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m19:30:49.727652 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:30:49.728646 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:49.728881 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:30:49.729086 [debug] [MainThread]: command return code=128
[0m19:30:49.729609 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:30:49.729832 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:49.730835 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:30:49.731068 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.731279 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:30:49.731574 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:30:49.732789 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:49.733016 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.733232 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:30:49.947590 [debug] [MainThread]: STDOUT: "b''"
[0m19:30:49.947982 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:30:49.948216 [debug] [MainThread]: Executing "git tag --list"
[0m19:30:49.949703 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:30:49.949960 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.950207 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:30:49.957749 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:30:49.957990 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.958208 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:30:49.959224 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:30:49.959488 [debug] [MainThread]: STDERR: "b''"
[0m19:30:49.959701 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:30:49.959947 [info ] [MainThread]: Installed from revision 0.8.2
[0m19:30:49.960629 [debug] [MainThread]: Command `dbt deps` succeeded at 19:30:49.960519 after 1.11 seconds
[0m19:30:49.960882 [debug] [MainThread]: Flushing usage events


============================== 19:30:51.448613 | 289f8340-b944-4615-a2d1-5f51b3ec223e ==============================
[0m19:30:51.448613 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:30:51.450794 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:30:51.536051 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m19:30:51.586861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:30:51.587406 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_tables/public/nsc.sql
[0m19:30:51.609851 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_tables/public/nsc.sql
[0m19:30:51.633272 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_tables/public/nsc.sql
[0m19:30:51.640667 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_views
- models.airbyte_utils.generated.airbyte_incremental
[0m19:30:51.653797 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:30:51.655088 [info ] [MainThread]: 
[0m19:30:51.655811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:51.656740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m19:30:51.666319 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m19:30:51.666607 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m19:30:51.666839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:51.676993 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:30:51.678020 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m19:30:51.679743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m19:30:51.685151 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:30:51.685416 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m19:30:51.685640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:51.693965 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:51.694229 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:30:51.694477 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:30:51.696531 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:30:51.697524 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m19:30:51.698127 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m19:30:51.703404 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:51.703667 [debug] [MainThread]: On master: BEGIN
[0m19:30:51.703886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:51.712319 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:51.712578 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:51.712880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:51.719615 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:30:51.720509 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:51.721166 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:51.721415 [debug] [MainThread]: On master: BEGIN
[0m19:30:51.722362 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:51.722626 [debug] [MainThread]: On master: COMMIT
[0m19:30:51.722851 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:51.723067 [debug] [MainThread]: On master: COMMIT
[0m19:30:51.723655 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:51.723906 [debug] [MainThread]: On master: Close
[0m19:30:51.724769 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m19:30:51.725277 [info ] [MainThread]: 
[0m19:30:51.728525 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m19:30:51.729137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m19:30:51.729441 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m19:30:51.764947 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m19:30:51.765571 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 19:30:51.729629 => 19:30:51.765331
[0m19:30:51.766317 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m19:30:51.767008 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m19:30:51.767690 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m19:30:51.767979 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m19:30:51.823261 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m19:30:51.823997 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 19:30:51.768157 => 19:30:51.823696
[0m19:30:51.824781 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m19:30:51.825492 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m19:30:51.826182 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m19:30:51.826513 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m19:30:51.897254 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m19:30:51.897838 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 19:30:51.826703 => 19:30:51.897603
[0m19:30:51.898577 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m19:30:51.899262 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m19:30:51.899715 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m19:30:51.900441 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m19:30:51.900732 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m19:30:51.916740 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m19:30:51.917270 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 19:30:51.900907 => 19:30:51.917055
[0m19:30:51.917562 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m19:30:51.951915 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m19:30:51.952477 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:30:51.952789 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m19:30:51.953064 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:30:51.962119 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:51.962437 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:30:51.962997 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "NameSuffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("NameSuffix" as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    NameSuffix,
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "DegreeMajor4",
    "DegreeMajor3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "RecordFoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m19:30:51.965026 [debug] [Thread-7 (]: Postgres adapter: Postgres error: column "namesuffix" does not exist
LINE 138:     NameSuffix,
              ^
HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.NameSuffix".

[0m19:30:51.965351 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: ROLLBACK
[0m19:30:51.966154 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 19:30:51.917743 => 19:30:51.965947
[0m19:30:51.966460 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m19:30:51.968812 [debug] [Thread-7 (]: Database Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)
  column "namesuffix" does not exist
  LINE 138:     NameSuffix,
                ^
  HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.NameSuffix".
  compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:30:51.969364 [error] [Thread-7 (]: 1 of 1 ERROR creating sql table model public.nsc ....................................................................... [[31mERROR[0m in 0.07s]
[0m19:30:51.969854 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m19:30:51.971332 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:51.971621 [debug] [MainThread]: On master: BEGIN
[0m19:30:51.971840 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:51.978884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:51.979153 [debug] [MainThread]: On master: COMMIT
[0m19:30:51.979414 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:51.979646 [debug] [MainThread]: On master: COMMIT
[0m19:30:51.980046 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:51.980299 [debug] [MainThread]: On master: Close
[0m19:30:51.981132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:51.981493 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m19:30:51.981799 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m19:30:51.982069 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m19:30:51.982372 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m19:30:51.982574 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m19:30:51.982808 [info ] [MainThread]: 
[0m19:30:51.983185 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m19:30:51.983707 [debug] [MainThread]: Command end result
[0m19:30:51.992764 [info ] [MainThread]: 
[0m19:30:51.993170 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:30:51.993498 [info ] [MainThread]: 
[0m19:30:51.993814 [error] [MainThread]: [33mDatabase Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)[0m
[0m19:30:51.994123 [error] [MainThread]:   column "namesuffix" does not exist
[0m19:30:51.994414 [error] [MainThread]:   LINE 138:     NameSuffix,
[0m19:30:51.994700 [error] [MainThread]:                 ^
[0m19:30:51.994985 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "__dbt__cte__nsc_ab3.NameSuffix".
[0m19:30:51.995267 [error] [MainThread]:   compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:30:51.995592 [info ] [MainThread]: 
[0m19:30:51.995912 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:30:51.996454 [debug] [MainThread]: Command `dbt run` failed at 19:30:51.996356 after 0.55 seconds
[0m19:30:51.996754 [debug] [MainThread]: Flushing usage events


============================== 19:42:11.127042 | 757a1818-38e4-41ac-90ea-5c667974b4c6 ==============================
[0m19:42:11.127042 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:42:11.129260 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:42:11.157332 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1jf6x0sq'
[0m19:42:11.157964 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:42:11.389299 [debug] [MainThread]: STDOUT: "b''"
[0m19:42:11.389703 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m19:42:11.390072 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m19:42:11.390310 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:42:11.391533 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m19:42:11.391771 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.391985 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:42:11.392207 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:42:11.393542 [debug] [MainThread]: STDOUT: "b''"
[0m19:42:11.393773 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.393993 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:42:11.706669 [debug] [MainThread]: STDOUT: "b''"
[0m19:42:11.707191 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m19:42:11.707587 [debug] [MainThread]: Executing "git tag --list"
[0m19:42:11.709050 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:42:11.709295 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.709513 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:42:11.722208 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:42:11.722446 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.722694 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:42:11.723750 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:42:11.723980 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.724194 [debug] [MainThread]: Checked out at 5717b10.
[0m19:42:11.724882 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:42:11.725854 [debug] [MainThread]: STDOUT: "b''"
[0m19:42:11.726085 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:42:11.726291 [debug] [MainThread]: command return code=128
[0m19:42:11.726881 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:42:11.727106 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:42:11.728148 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:42:11.728375 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.728580 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:42:11.728787 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:42:11.730019 [debug] [MainThread]: STDOUT: "b''"
[0m19:42:11.730243 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.730458 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:42:11.934005 [debug] [MainThread]: STDOUT: "b''"
[0m19:42:11.934409 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:42:11.934662 [debug] [MainThread]: Executing "git tag --list"
[0m19:42:11.936371 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:42:11.936648 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.936883 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:42:11.944708 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:42:11.944944 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.945167 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:42:11.946186 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:42:11.946418 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.946627 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:42:11.947391 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m19:42:11.952990 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:42:11.953966 [debug] [MainThread]: STDOUT: "b''"
[0m19:42:11.954194 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:42:11.954395 [debug] [MainThread]: command return code=128
[0m19:42:11.954836 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:42:11.955045 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:42:11.956117 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:42:11.956342 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.956547 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:42:11.956753 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:42:11.957999 [debug] [MainThread]: STDOUT: "b''"
[0m19:42:11.958224 [debug] [MainThread]: STDERR: "b''"
[0m19:42:11.958439 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:42:12.174809 [debug] [MainThread]: STDOUT: "b''"
[0m19:42:12.175195 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:42:12.175471 [debug] [MainThread]: Executing "git tag --list"
[0m19:42:12.176944 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:42:12.177191 [debug] [MainThread]: STDERR: "b''"
[0m19:42:12.177417 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:42:12.184443 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:42:12.184678 [debug] [MainThread]: STDERR: "b''"
[0m19:42:12.184896 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:42:12.185911 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:42:12.186136 [debug] [MainThread]: STDERR: "b''"
[0m19:42:12.186343 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:42:12.186586 [info ] [MainThread]: Installed from revision 0.8.2
[0m19:42:12.187305 [debug] [MainThread]: Command `dbt deps` succeeded at 19:42:12.187199 after 1.07 seconds
[0m19:42:12.187596 [debug] [MainThread]: Flushing usage events


============================== 19:42:13.665578 | 289c7da5-1134-407f-89da-73922e3fb30f ==============================
[0m19:42:13.665578 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:42:13.667787 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'fail_fast': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:42:13.754702 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m19:42:13.806811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:42:13.807318 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_ctes/public/nsc_ab2.sql
[0m19:42:13.807684 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_ctes/public/nsc_ab3.sql
[0m19:42:13.830213 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab2.sql
[0m19:42:13.875872 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab2.sql
[0m19:42:13.878104 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab3.sql
[0m19:42:13.904009 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab3.sql
[0m19:42:13.911111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_incremental
- models.airbyte_utils.generated.airbyte_views
[0m19:42:13.924454 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:42:13.925786 [info ] [MainThread]: 
[0m19:42:13.926537 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:42:13.927495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m19:42:13.936737 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m19:42:13.937015 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m19:42:13.937247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:13.947875 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:42:13.948953 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m19:42:13.951215 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m19:42:13.956937 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:42:13.957208 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m19:42:13.957434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:13.966497 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:42:13.966770 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:42:13.967025 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:42:13.969115 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:42:13.970137 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m19:42:13.970756 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m19:42:13.976782 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:13.977048 [debug] [MainThread]: On master: BEGIN
[0m19:42:13.977271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:42:13.986279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:42:13.986554 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:13.986880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:42:13.993645 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:42:13.994609 [debug] [MainThread]: On master: ROLLBACK
[0m19:42:13.995246 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:13.995529 [debug] [MainThread]: On master: BEGIN
[0m19:42:13.996559 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:42:13.996812 [debug] [MainThread]: On master: COMMIT
[0m19:42:13.997041 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:13.997259 [debug] [MainThread]: On master: COMMIT
[0m19:42:13.997838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:42:13.998090 [debug] [MainThread]: On master: Close
[0m19:42:13.998929 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m19:42:13.999400 [info ] [MainThread]: 
[0m19:42:14.002655 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m19:42:14.003351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m19:42:14.003678 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m19:42:14.039199 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m19:42:14.039840 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 19:42:14.003868 => 19:42:14.039610
[0m19:42:14.040626 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m19:42:14.041349 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m19:42:14.042033 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m19:42:14.042362 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m19:42:14.088290 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m19:42:14.088981 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 19:42:14.042549 => 19:42:14.088750
[0m19:42:14.089780 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m19:42:14.090472 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m19:42:14.091169 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m19:42:14.091599 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m19:42:14.153995 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m19:42:14.154726 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 19:42:14.091796 => 19:42:14.154478
[0m19:42:14.155610 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m19:42:14.156379 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m19:42:14.156815 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m19:42:14.157620 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m19:42:14.157917 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m19:42:14.174242 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m19:42:14.174781 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 19:42:14.158096 => 19:42:14.174569
[0m19:42:14.175073 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m19:42:14.209116 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m19:42:14.209615 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:42:14.209919 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m19:42:14.210198 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:42:14.219999 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m19:42:14.220335 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:42:14.220903 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as NameSuffix,
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast( as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    NameSuffix,
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "DegreeMajor4",
    "DegreeMajor3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "RecordFoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m19:42:14.222434 [debug] [Thread-7 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
                                      ^

[0m19:42:14.222756 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: ROLLBACK
[0m19:42:14.223571 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 19:42:14.175252 => 19:42:14.223353
[0m19:42:14.223880 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m19:42:14.226049 [debug] [Thread-7 (]: Database Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)
  syntax error at or near "as"
  LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
                                        ^
  compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:42:14.226597 [error] [Thread-7 (]: 1 of 1 ERROR creating sql table model public.nsc ....................................................................... [[31mERROR[0m in 0.07s]
[0m19:42:14.227133 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m19:42:14.228722 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:14.228986 [debug] [MainThread]: On master: BEGIN
[0m19:42:14.229210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:42:14.237788 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:42:14.238063 [debug] [MainThread]: On master: COMMIT
[0m19:42:14.238302 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:14.238529 [debug] [MainThread]: On master: COMMIT
[0m19:42:14.239126 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:42:14.239418 [debug] [MainThread]: On master: Close
[0m19:42:14.240263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:14.240589 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m19:42:14.240884 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m19:42:14.241155 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m19:42:14.241446 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m19:42:14.241647 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m19:42:14.241889 [info ] [MainThread]: 
[0m19:42:14.242241 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m19:42:14.242743 [debug] [MainThread]: Command end result
[0m19:42:14.252654 [info ] [MainThread]: 
[0m19:42:14.253074 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:42:14.253397 [info ] [MainThread]: 
[0m19:42:14.253732 [error] [MainThread]: [33mDatabase Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)[0m
[0m19:42:14.254049 [error] [MainThread]:   syntax error at or near "as"
[0m19:42:14.254356 [error] [MainThread]:   LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
[0m19:42:14.254661 [error] [MainThread]:                                         ^
[0m19:42:14.254974 [error] [MainThread]:   compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:42:14.255267 [info ] [MainThread]: 
[0m19:42:14.255637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:42:14.256220 [debug] [MainThread]: Command `dbt run` failed at 19:42:14.256117 after 0.60 seconds
[0m19:42:14.256501 [debug] [MainThread]: Flushing usage events


============================== 19:50:01.507599 | 10de72df-2ebc-4918-a0a6-8b4b660ca08f ==============================
[0m19:50:01.507599 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:50:01.509811 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:50:01.536731 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kj32x_29'
[0m19:50:01.537288 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:50:01.859563 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:01.859961 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m19:50:01.860334 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m19:50:01.860569 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:01.861713 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m19:50:01.861962 [debug] [MainThread]: STDERR: "b''"
[0m19:50:01.862186 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:50:01.862415 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:50:01.863761 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:01.863991 [debug] [MainThread]: STDERR: "b''"
[0m19:50:01.864213 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:50:02.488929 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:02.489460 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m19:50:02.489815 [debug] [MainThread]: Executing "git tag --list"
[0m19:50:02.491309 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:50:02.491594 [debug] [MainThread]: STDERR: "b''"
[0m19:50:02.491818 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:50:02.504373 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:50:02.504647 [debug] [MainThread]: STDERR: "b''"
[0m19:50:02.504868 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:02.505911 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:50:02.506140 [debug] [MainThread]: STDERR: "b''"
[0m19:50:02.506351 [debug] [MainThread]: Checked out at 5717b10.
[0m19:50:02.507036 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:50:02.508051 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:02.508288 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:50:02.508491 [debug] [MainThread]: command return code=128
[0m19:50:02.509087 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:50:02.509313 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:02.510315 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:50:02.510561 [debug] [MainThread]: STDERR: "b''"
[0m19:50:02.510767 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:50:02.510978 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:50:02.512239 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:02.512470 [debug] [MainThread]: STDERR: "b''"
[0m19:50:02.512686 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:50:02.880315 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:02.880700 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:50:02.880965 [debug] [MainThread]: Executing "git tag --list"
[0m19:50:02.882428 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:50:02.882678 [debug] [MainThread]: STDERR: "b''"
[0m19:50:02.882897 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:50:02.891131 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:50:02.891391 [debug] [MainThread]: STDERR: "b''"
[0m19:50:02.891615 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:02.892619 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:50:02.892842 [debug] [MainThread]: STDERR: "b''"
[0m19:50:02.893047 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:50:02.893770 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m19:50:02.903116 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:50:02.904160 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:02.904396 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:50:02.904600 [debug] [MainThread]: command return code=128
[0m19:50:02.905035 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:50:02.905248 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:02.906256 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:50:02.906480 [debug] [MainThread]: STDERR: "b''"
[0m19:50:02.906691 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:50:02.906896 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:50:02.908145 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:02.908371 [debug] [MainThread]: STDERR: "b''"
[0m19:50:02.908586 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:50:03.120380 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:03.120775 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:50:03.121012 [debug] [MainThread]: Executing "git tag --list"
[0m19:50:03.122488 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:50:03.122762 [debug] [MainThread]: STDERR: "b''"
[0m19:50:03.122989 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:50:03.129539 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:50:03.129774 [debug] [MainThread]: STDERR: "b''"
[0m19:50:03.129990 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:03.131001 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:50:03.131225 [debug] [MainThread]: STDERR: "b''"
[0m19:50:03.131507 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:50:03.131759 [info ] [MainThread]: Installed from revision 0.8.2
[0m19:50:03.132443 [debug] [MainThread]: Command `dbt deps` succeeded at 19:50:03.132336 after 1.63 seconds
[0m19:50:03.132692 [debug] [MainThread]: Flushing usage events


============================== 19:50:04.624244 | a0de3dd0-ccb4-4ae8-a644-fca06decb966 ==============================
[0m19:50:04.624244 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:50:04.626426 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:50:04.712783 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m19:50:04.762924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:50:04.763470 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_tables/public/nsc.sql
[0m19:50:04.785491 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_tables/public/nsc.sql
[0m19:50:04.808661 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_tables/public/nsc.sql
[0m19:50:04.815724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_views
- models.airbyte_utils.generated.airbyte_incremental
[0m19:50:04.828463 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:50:04.829738 [info ] [MainThread]: 
[0m19:50:04.830461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:50:04.831399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m19:50:04.840900 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m19:50:04.841178 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m19:50:04.841411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:04.851642 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:50:04.852676 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m19:50:04.854532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m19:50:04.859927 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:50:04.860198 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m19:50:04.860421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:04.869027 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:50:04.869293 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:50:04.869541 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:50:04.871670 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:50:04.872715 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m19:50:04.873364 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m19:50:04.878685 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:04.878948 [debug] [MainThread]: On master: BEGIN
[0m19:50:04.879168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:04.888853 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:50:04.889119 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:04.889434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:50:04.896370 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:50:04.897318 [debug] [MainThread]: On master: ROLLBACK
[0m19:50:04.897822 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:04.898079 [debug] [MainThread]: On master: BEGIN
[0m19:50:04.898700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:50:04.898955 [debug] [MainThread]: On master: COMMIT
[0m19:50:04.899184 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:04.899430 [debug] [MainThread]: On master: COMMIT
[0m19:50:04.899858 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:50:04.900107 [debug] [MainThread]: On master: Close
[0m19:50:04.900994 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m19:50:04.901477 [info ] [MainThread]: 
[0m19:50:04.904803 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m19:50:04.905421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m19:50:04.905722 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m19:50:04.941422 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m19:50:04.942042 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 19:50:04.905909 => 19:50:04.941805
[0m19:50:04.942797 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m19:50:04.943510 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m19:50:04.944170 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m19:50:04.944460 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m19:50:04.999405 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m19:50:05.000153 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 19:50:04.944638 => 19:50:04.999894
[0m19:50:05.000975 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m19:50:05.001680 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m19:50:05.002466 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m19:50:05.002764 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m19:50:05.074529 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m19:50:05.075313 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 19:50:05.002954 => 19:50:05.075040
[0m19:50:05.076244 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m19:50:05.077069 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m19:50:05.077544 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m19:50:05.078409 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m19:50:05.078711 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m19:50:05.095887 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m19:50:05.096534 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 19:50:05.078893 => 19:50:05.096287
[0m19:50:05.096846 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m19:50:05.132125 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m19:50:05.132746 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:50:05.133091 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m19:50:05.133363 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:50:05.142811 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m19:50:05.143135 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:50:05.143733 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as NameSuffix,
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast( as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "NameSuffix",
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "DegreeMajor4",
    "DegreeMajor3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "RecordFoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m19:50:05.145154 [debug] [Thread-7 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
                                      ^

[0m19:50:05.145480 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: ROLLBACK
[0m19:50:05.146383 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 19:50:05.097035 => 19:50:05.146171
[0m19:50:05.146686 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m19:50:05.149027 [debug] [Thread-7 (]: Database Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)
  syntax error at or near "as"
  LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
                                        ^
  compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:50:05.149622 [error] [Thread-7 (]: 1 of 1 ERROR creating sql table model public.nsc ....................................................................... [[31mERROR[0m in 0.07s]
[0m19:50:05.150131 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m19:50:05.151771 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:05.152039 [debug] [MainThread]: On master: BEGIN
[0m19:50:05.152265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:05.161131 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:50:05.161417 [debug] [MainThread]: On master: COMMIT
[0m19:50:05.161655 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:05.161881 [debug] [MainThread]: On master: COMMIT
[0m19:50:05.162456 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:50:05.162713 [debug] [MainThread]: On master: Close
[0m19:50:05.163581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:05.163913 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m19:50:05.164206 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m19:50:05.164484 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m19:50:05.164741 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m19:50:05.164984 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m19:50:05.165236 [info ] [MainThread]: 
[0m19:50:05.165589 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m19:50:05.166105 [debug] [MainThread]: Command end result
[0m19:50:05.175063 [info ] [MainThread]: 
[0m19:50:05.175518 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:50:05.175852 [info ] [MainThread]: 
[0m19:50:05.176182 [error] [MainThread]: [33mDatabase Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)[0m
[0m19:50:05.176506 [error] [MainThread]:   syntax error at or near "as"
[0m19:50:05.176828 [error] [MainThread]:   LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
[0m19:50:05.177127 [error] [MainThread]:                                         ^
[0m19:50:05.177435 [error] [MainThread]:   compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:50:05.177730 [info ] [MainThread]: 
[0m19:50:05.178048 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:50:05.178616 [debug] [MainThread]: Command `dbt run` failed at 19:50:05.178492 after 0.56 seconds
[0m19:50:05.178897 [debug] [MainThread]: Flushing usage events


============================== 19:50:40.206813 | 69e35370-ab6f-4dbc-9c50-b747057f8c81 ==============================
[0m19:50:40.206813 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:50:40.209034 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:50:40.235596 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-twi0oy_z'
[0m19:50:40.236020 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:50:40.471250 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:40.471684 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m19:50:40.472049 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m19:50:40.472282 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:40.473407 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m19:50:40.473639 [debug] [MainThread]: STDERR: "b''"
[0m19:50:40.473850 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:50:40.474074 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:50:40.475399 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:40.475628 [debug] [MainThread]: STDERR: "b''"
[0m19:50:40.475845 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:50:40.802792 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:40.803294 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m19:50:40.803692 [debug] [MainThread]: Executing "git tag --list"
[0m19:50:40.805155 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:50:40.805398 [debug] [MainThread]: STDERR: "b''"
[0m19:50:40.805616 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:50:40.816446 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:50:40.816684 [debug] [MainThread]: STDERR: "b''"
[0m19:50:40.816900 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:40.817921 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:50:40.818151 [debug] [MainThread]: STDERR: "b''"
[0m19:50:40.818360 [debug] [MainThread]: Checked out at 5717b10.
[0m19:50:40.819060 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:50:40.820100 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:40.820333 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:50:40.820533 [debug] [MainThread]: command return code=128
[0m19:50:40.821123 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:50:40.821344 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:40.822340 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:50:40.822568 [debug] [MainThread]: STDERR: "b''"
[0m19:50:40.822769 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:50:40.822985 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:50:40.824286 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:40.824506 [debug] [MainThread]: STDERR: "b''"
[0m19:50:40.824716 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:50:41.032930 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:41.033316 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:50:41.033561 [debug] [MainThread]: Executing "git tag --list"
[0m19:50:41.035004 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:50:41.035249 [debug] [MainThread]: STDERR: "b''"
[0m19:50:41.035497 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:50:41.043277 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:50:41.043565 [debug] [MainThread]: STDERR: "b''"
[0m19:50:41.043782 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:41.044812 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:50:41.045035 [debug] [MainThread]: STDERR: "b''"
[0m19:50:41.045242 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:50:41.046030 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m19:50:41.051812 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:50:41.052807 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:41.053037 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:50:41.053238 [debug] [MainThread]: command return code=128
[0m19:50:41.053668 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:50:41.053875 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:41.054887 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:50:41.055110 [debug] [MainThread]: STDERR: "b''"
[0m19:50:41.055316 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:50:41.055580 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:50:41.056793 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:41.057015 [debug] [MainThread]: STDERR: "b''"
[0m19:50:41.057228 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:50:41.275098 [debug] [MainThread]: STDOUT: "b''"
[0m19:50:41.275527 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:50:41.275772 [debug] [MainThread]: Executing "git tag --list"
[0m19:50:41.277228 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:50:41.277473 [debug] [MainThread]: STDERR: "b''"
[0m19:50:41.277723 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:50:41.283887 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:50:41.284117 [debug] [MainThread]: STDERR: "b''"
[0m19:50:41.284328 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:50:41.285333 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:50:41.285555 [debug] [MainThread]: STDERR: "b''"
[0m19:50:41.285757 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:50:41.285998 [info ] [MainThread]: Installed from revision 0.8.2
[0m19:50:41.286669 [debug] [MainThread]: Command `dbt deps` succeeded at 19:50:41.286562 after 1.09 seconds
[0m19:50:41.286921 [debug] [MainThread]: Flushing usage events


============================== 19:50:42.764863 | d071cfa5-8d43-42e2-8aad-f5d983b66caf ==============================
[0m19:50:42.764863 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:50:42.767075 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:50:42.853482 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m19:50:42.908230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:50:42.908751 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_tables/public/nsc.sql
[0m19:50:42.930598 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_tables/public/nsc.sql
[0m19:50:42.954632 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_tables/public/nsc.sql
[0m19:50:42.961862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_incremental
- models.airbyte_utils.generated.airbyte_views
[0m19:50:42.974746 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:50:42.976055 [info ] [MainThread]: 
[0m19:50:42.976775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:50:42.977692 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m19:50:42.987121 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m19:50:42.987439 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m19:50:42.987686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:42.997847 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:50:42.998894 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m19:50:43.000719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m19:50:43.006067 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:50:43.006337 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m19:50:43.006587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:43.015152 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:50:43.015456 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:50:43.015710 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:50:43.017826 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:50:43.018830 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m19:50:43.019480 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m19:50:43.024832 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:43.025100 [debug] [MainThread]: On master: BEGIN
[0m19:50:43.025320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:43.032106 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:50:43.032368 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:43.032669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:50:43.039112 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:50:43.040070 [debug] [MainThread]: On master: ROLLBACK
[0m19:50:43.040531 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:43.040792 [debug] [MainThread]: On master: BEGIN
[0m19:50:43.041400 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:50:43.041655 [debug] [MainThread]: On master: COMMIT
[0m19:50:43.041882 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:43.042097 [debug] [MainThread]: On master: COMMIT
[0m19:50:43.042494 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:50:43.042745 [debug] [MainThread]: On master: Close
[0m19:50:43.043597 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m19:50:43.044086 [info ] [MainThread]: 
[0m19:50:43.047423 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m19:50:43.048037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m19:50:43.048344 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m19:50:43.085140 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m19:50:43.085817 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 19:50:43.048532 => 19:50:43.085581
[0m19:50:43.086629 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m19:50:43.087424 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m19:50:43.088111 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m19:50:43.088401 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m19:50:43.143704 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m19:50:43.144284 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 19:50:43.088579 => 19:50:43.144082
[0m19:50:43.145072 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m19:50:43.145653 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m19:50:43.146442 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m19:50:43.146831 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m19:50:43.219115 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m19:50:43.219815 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 19:50:43.147169 => 19:50:43.219567
[0m19:50:43.220601 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m19:50:43.221339 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m19:50:43.221781 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m19:50:43.222580 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m19:50:43.222873 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m19:50:43.239122 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m19:50:43.239702 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 19:50:43.223054 => 19:50:43.239469
[0m19:50:43.240002 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m19:50:43.274355 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m19:50:43.274915 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:50:43.275223 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m19:50:43.275538 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:50:43.283542 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m19:50:43.283866 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:50:43.284431 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as NameSuffix,
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast( as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "NameSuffix",
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "DegreeMajor4",
    "DegreeMajor3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "RecordFoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m19:50:43.285664 [debug] [Thread-7 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
                                      ^

[0m19:50:43.285983 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: ROLLBACK
[0m19:50:43.286604 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 19:50:43.240186 => 19:50:43.286394
[0m19:50:43.286906 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m19:50:43.289191 [debug] [Thread-7 (]: Database Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)
  syntax error at or near "as"
  LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
                                        ^
  compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:50:43.289750 [error] [Thread-7 (]: 1 of 1 ERROR creating sql table model public.nsc ....................................................................... [[31mERROR[0m in 0.07s]
[0m19:50:43.290242 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m19:50:43.291853 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:43.292111 [debug] [MainThread]: On master: BEGIN
[0m19:50:43.292332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:43.300726 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:50:43.300996 [debug] [MainThread]: On master: COMMIT
[0m19:50:43.301234 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:43.301456 [debug] [MainThread]: On master: COMMIT
[0m19:50:43.302072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:50:43.302330 [debug] [MainThread]: On master: Close
[0m19:50:43.303114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:43.303475 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m19:50:43.303776 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m19:50:43.304043 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m19:50:43.304342 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m19:50:43.304552 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m19:50:43.304793 [info ] [MainThread]: 
[0m19:50:43.305141 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m19:50:43.305637 [debug] [MainThread]: Command end result
[0m19:50:43.314331 [info ] [MainThread]: 
[0m19:50:43.314719 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:50:43.315048 [info ] [MainThread]: 
[0m19:50:43.315403 [error] [MainThread]: [33mDatabase Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)[0m
[0m19:50:43.315737 [error] [MainThread]:   syntax error at or near "as"
[0m19:50:43.316048 [error] [MainThread]:   LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
[0m19:50:43.316357 [error] [MainThread]:                                         ^
[0m19:50:43.316655 [error] [MainThread]:   compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:50:43.316945 [info ] [MainThread]: 
[0m19:50:43.317259 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:50:43.317796 [debug] [MainThread]: Command `dbt run` failed at 19:50:43.317697 after 0.56 seconds
[0m19:50:43.318066 [debug] [MainThread]: Flushing usage events


============================== 19:52:22.238282 | fb51d347-fa04-4ccf-9aad-f88de388a8e1 ==============================
[0m19:52:22.238282 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:52:22.240516 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:52:22.267002 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j7hv8ky6'
[0m19:52:22.267483 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:52:22.496179 [debug] [MainThread]: STDOUT: "b''"
[0m19:52:22.496574 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m19:52:22.496932 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m19:52:22.497163 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:52:22.498328 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m19:52:22.498555 [debug] [MainThread]: STDERR: "b''"
[0m19:52:22.498764 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:52:22.498992 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:52:22.500330 [debug] [MainThread]: STDOUT: "b''"
[0m19:52:22.500559 [debug] [MainThread]: STDERR: "b''"
[0m19:52:22.500777 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:52:22.825355 [debug] [MainThread]: STDOUT: "b''"
[0m19:52:22.826030 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m19:52:22.826423 [debug] [MainThread]: Executing "git tag --list"
[0m19:52:22.827977 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:52:22.828225 [debug] [MainThread]: STDERR: "b''"
[0m19:52:22.828446 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:52:22.839727 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:52:22.839977 [debug] [MainThread]: STDERR: "b''"
[0m19:52:22.840251 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:52:22.841301 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:52:22.841527 [debug] [MainThread]: STDERR: "b''"
[0m19:52:22.841737 [debug] [MainThread]: Checked out at 5717b10.
[0m19:52:22.842422 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:52:22.843420 [debug] [MainThread]: STDOUT: "b''"
[0m19:52:22.843648 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:52:22.843851 [debug] [MainThread]: command return code=128
[0m19:52:22.844444 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:52:22.844661 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:52:22.845676 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:52:22.845903 [debug] [MainThread]: STDERR: "b''"
[0m19:52:22.846105 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:52:22.846312 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:52:22.847743 [debug] [MainThread]: STDOUT: "b''"
[0m19:52:22.847966 [debug] [MainThread]: STDERR: "b''"
[0m19:52:22.848178 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:52:23.062446 [debug] [MainThread]: STDOUT: "b''"
[0m19:52:23.062839 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:52:23.063080 [debug] [MainThread]: Executing "git tag --list"
[0m19:52:23.064580 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:52:23.064829 [debug] [MainThread]: STDERR: "b''"
[0m19:52:23.065050 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:52:23.076197 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:52:23.076451 [debug] [MainThread]: STDERR: "b''"
[0m19:52:23.076668 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:52:23.077771 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:52:23.077997 [debug] [MainThread]: STDERR: "b''"
[0m19:52:23.078204 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:52:23.078930 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m19:52:23.084935 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m19:52:23.085956 [debug] [MainThread]: STDOUT: "b''"
[0m19:52:23.086188 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m19:52:23.086391 [debug] [MainThread]: command return code=128
[0m19:52:23.086830 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m19:52:23.087038 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:52:23.088067 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:52:23.088292 [debug] [MainThread]: STDERR: "b''"
[0m19:52:23.088497 [debug] [MainThread]: Checking out revision 0.8.2.
[0m19:52:23.088704 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m19:52:23.089957 [debug] [MainThread]: STDOUT: "b''"
[0m19:52:23.090207 [debug] [MainThread]: STDERR: "b''"
[0m19:52:23.090421 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m19:52:23.308357 [debug] [MainThread]: STDOUT: "b''"
[0m19:52:23.308753 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m19:52:23.308995 [debug] [MainThread]: Executing "git tag --list"
[0m19:52:23.310500 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m19:52:23.310751 [debug] [MainThread]: STDERR: "b''"
[0m19:52:23.310971 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m19:52:23.383247 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m19:52:23.383669 [debug] [MainThread]: STDERR: "b''"
[0m19:52:23.383903 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:52:23.385261 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m19:52:23.385497 [debug] [MainThread]: STDERR: "b''"
[0m19:52:23.385709 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m19:52:23.386612 [info ] [MainThread]: Installed from revision 0.8.2
[0m19:52:23.387333 [debug] [MainThread]: Command `dbt deps` succeeded at 19:52:23.387224 after 1.16 seconds
[0m19:52:23.387672 [debug] [MainThread]: Flushing usage events


============================== 19:52:24.915316 | 2104468c-81ff-421a-a593-bd4cad3a53ba ==============================
[0m19:52:24.915316 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:52:24.917518 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'version_check': 'True', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m19:52:25.004349 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m19:52:25.059894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:52:25.060446 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_ctes/public/nsc_ab3.sql
[0m19:52:25.060779 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_ctes/public/nsc_ab2.sql
[0m19:52:25.083135 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab3.sql
[0m19:52:25.120636 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab3.sql
[0m19:52:25.123710 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab2.sql
[0m19:52:25.160737 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab2.sql
[0m19:52:25.168348 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_views
- models.airbyte_utils.generated.airbyte_incremental
[0m19:52:25.182218 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:52:25.183621 [info ] [MainThread]: 
[0m19:52:25.184354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:52:25.185295 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m19:52:25.194876 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m19:52:25.195176 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m19:52:25.195447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:25.206074 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:52:25.207256 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m19:52:25.209137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datahub_staging, now list_datahub_staging_public)
[0m19:52:25.214750 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:52:25.215019 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m19:52:25.215244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:25.223903 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:52:25.224182 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m19:52:25.224432 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:52:25.226515 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:52:25.227620 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m19:52:25.228246 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m19:52:25.234300 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:25.234565 [debug] [MainThread]: On master: BEGIN
[0m19:52:25.234793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:25.243170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:52:25.243476 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:25.243787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:52:25.250546 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:52:25.251550 [debug] [MainThread]: On master: ROLLBACK
[0m19:52:25.252300 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:25.252550 [debug] [MainThread]: On master: BEGIN
[0m19:52:25.253737 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:52:25.253992 [debug] [MainThread]: On master: COMMIT
[0m19:52:25.254222 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:25.254454 [debug] [MainThread]: On master: COMMIT
[0m19:52:25.255105 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:52:25.255382 [debug] [MainThread]: On master: Close
[0m19:52:25.256240 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m19:52:25.256792 [info ] [MainThread]: 
[0m19:52:25.260221 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m19:52:25.260859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m19:52:25.261165 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m19:52:25.296835 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m19:52:25.297534 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 19:52:25.261350 => 19:52:25.297285
[0m19:52:25.298347 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m19:52:25.299102 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m19:52:25.300052 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m19:52:25.300474 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m19:52:25.347671 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m19:52:25.348379 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 19:52:25.300670 => 19:52:25.348127
[0m19:52:25.349171 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m19:52:25.349937 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m19:52:25.350644 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m19:52:25.350942 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m19:52:25.413784 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m19:52:25.414598 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 19:52:25.351123 => 19:52:25.414318
[0m19:52:25.415551 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m19:52:25.416363 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m19:52:25.416836 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m19:52:25.417656 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m19:52:25.417963 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m19:52:25.435093 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m19:52:25.435770 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 19:52:25.418146 => 19:52:25.435525
[0m19:52:25.436082 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m19:52:25.470991 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m19:52:25.471639 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:52:25.471967 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m19:52:25.472247 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:52:25.481397 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m19:52:25.481745 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m19:52:25.482334 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "NameSuffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast(NameSuffix as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "NameSuffix",
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "DegreeMajor4",
    "DegreeMajor3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "RecordFoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m19:52:25.484390 [debug] [Thread-7 (]: Postgres adapter: Postgres error: column "namesuffix" does not exist
LINE 130:     md5(cast(coalesce(cast(NameSuffix as text), '') || '-' |...
                                     ^
HINT:  Perhaps you meant to reference the column "tmp.NameSuffix".

[0m19:52:25.484766 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: ROLLBACK
[0m19:52:25.485591 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 19:52:25.436272 => 19:52:25.485378
[0m19:52:25.485902 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m19:52:25.488506 [debug] [Thread-7 (]: Database Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)
  column "namesuffix" does not exist
  LINE 130:     md5(cast(coalesce(cast(NameSuffix as text), '') || '-' |...
                                       ^
  HINT:  Perhaps you meant to reference the column "tmp.NameSuffix".
  compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:52:25.489105 [error] [Thread-7 (]: 1 of 1 ERROR creating sql table model public.nsc ....................................................................... [[31mERROR[0m in 0.07s]
[0m19:52:25.489606 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m19:52:25.491164 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:25.491455 [debug] [MainThread]: On master: BEGIN
[0m19:52:25.491693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:25.500337 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:52:25.500628 [debug] [MainThread]: On master: COMMIT
[0m19:52:25.500867 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:25.501092 [debug] [MainThread]: On master: COMMIT
[0m19:52:25.501637 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:52:25.501891 [debug] [MainThread]: On master: Close
[0m19:52:25.502679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:25.503002 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m19:52:25.503297 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m19:52:25.503616 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m19:52:25.503895 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m19:52:25.504153 [info ] [MainThread]: 
[0m19:52:25.504509 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m19:52:25.505025 [debug] [MainThread]: Command end result
[0m19:52:25.514692 [info ] [MainThread]: 
[0m19:52:25.515161 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:52:25.515513 [info ] [MainThread]: 
[0m19:52:25.515848 [error] [MainThread]: [33mDatabase Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)[0m
[0m19:52:25.516201 [error] [MainThread]:   column "namesuffix" does not exist
[0m19:52:25.516508 [error] [MainThread]:   LINE 130:     md5(cast(coalesce(cast(NameSuffix as text), '') || '-' |...
[0m19:52:25.516810 [error] [MainThread]:                                        ^
[0m19:52:25.517133 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "tmp.NameSuffix".
[0m19:52:25.517423 [error] [MainThread]:   compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m19:52:25.517713 [info ] [MainThread]: 
[0m19:52:25.518033 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:52:25.518574 [debug] [MainThread]: Command `dbt run` failed at 19:52:25.518475 after 0.61 seconds
[0m19:52:25.518896 [debug] [MainThread]: Flushing usage events


============================== 20:07:51.383080 | 6126837f-fab4-4ec3-9bb3-d1cd9d7756a7 ==============================
[0m20:07:51.383080 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:07:51.385700 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m20:07:51.412460 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3ni5syam'
[0m20:07:51.412903 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m20:07:51.645824 [debug] [MainThread]: STDOUT: "b''"
[0m20:07:51.646220 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m20:07:51.646589 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m20:07:51.646825 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:07:51.647965 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m20:07:51.648204 [debug] [MainThread]: STDERR: "b''"
[0m20:07:51.648414 [debug] [MainThread]: Checking out revision 0.8.2.
[0m20:07:51.648631 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m20:07:51.649926 [debug] [MainThread]: STDOUT: "b''"
[0m20:07:51.650155 [debug] [MainThread]: STDERR: "b''"
[0m20:07:51.650370 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m20:07:51.967810 [debug] [MainThread]: STDOUT: "b''"
[0m20:07:51.968317 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m20:07:51.968677 [debug] [MainThread]: Executing "git tag --list"
[0m20:07:51.970148 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m20:07:51.970395 [debug] [MainThread]: STDERR: "b''"
[0m20:07:51.970611 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m20:07:51.982122 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m20:07:51.982357 [debug] [MainThread]: STDERR: "b''"
[0m20:07:51.982572 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:07:51.983688 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:07:51.983916 [debug] [MainThread]: STDERR: "b''"
[0m20:07:51.984124 [debug] [MainThread]: Checked out at 5717b10.
[0m20:07:51.984812 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m20:07:51.985826 [debug] [MainThread]: STDOUT: "b''"
[0m20:07:51.986055 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m20:07:51.986255 [debug] [MainThread]: command return code=128
[0m20:07:51.986870 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m20:07:51.987115 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:07:51.988562 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:07:51.988800 [debug] [MainThread]: STDERR: "b''"
[0m20:07:51.989003 [debug] [MainThread]: Checking out revision 0.8.2.
[0m20:07:51.989246 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m20:07:51.990495 [debug] [MainThread]: STDOUT: "b''"
[0m20:07:51.990720 [debug] [MainThread]: STDERR: "b''"
[0m20:07:51.990934 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m20:07:52.203479 [debug] [MainThread]: STDOUT: "b''"
[0m20:07:52.203873 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m20:07:52.204115 [debug] [MainThread]: Executing "git tag --list"
[0m20:07:52.205581 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m20:07:52.205842 [debug] [MainThread]: STDERR: "b''"
[0m20:07:52.206076 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m20:07:52.213991 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m20:07:52.214281 [debug] [MainThread]: STDERR: "b''"
[0m20:07:52.214536 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:07:52.215582 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:07:52.215811 [debug] [MainThread]: STDERR: "b''"
[0m20:07:52.216018 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m20:07:52.216740 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m20:07:52.222469 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m20:07:52.223475 [debug] [MainThread]: STDOUT: "b''"
[0m20:07:52.223709 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m20:07:52.223912 [debug] [MainThread]: command return code=128
[0m20:07:52.224350 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m20:07:52.224561 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:07:52.225562 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:07:52.225790 [debug] [MainThread]: STDERR: "b''"
[0m20:07:52.225993 [debug] [MainThread]: Checking out revision 0.8.2.
[0m20:07:52.226204 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m20:07:52.227559 [debug] [MainThread]: STDOUT: "b''"
[0m20:07:52.227787 [debug] [MainThread]: STDERR: "b''"
[0m20:07:52.228003 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m20:07:52.535608 [debug] [MainThread]: STDOUT: "b''"
[0m20:07:52.536008 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m20:07:52.536250 [debug] [MainThread]: Executing "git tag --list"
[0m20:07:52.537715 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m20:07:52.537967 [debug] [MainThread]: STDERR: "b''"
[0m20:07:52.538189 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m20:07:52.543567 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m20:07:52.543856 [debug] [MainThread]: STDERR: "b''"
[0m20:07:52.544124 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:07:52.545138 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:07:52.545368 [debug] [MainThread]: STDERR: "b''"
[0m20:07:52.545573 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m20:07:52.545818 [info ] [MainThread]: Installed from revision 0.8.2
[0m20:07:52.546524 [debug] [MainThread]: Command `dbt deps` succeeded at 20:07:52.546414 after 1.17 seconds
[0m20:07:52.546780 [debug] [MainThread]: Flushing usage events


============================== 20:07:54.006579 | 34fa11b0-0533-428a-bc5c-310a288d6696 ==============================
[0m20:07:54.006579 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:07:54.008803 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m20:07:54.093619 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:07:54.144460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:07:54.145004 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_ctes/public/nsc_ab2.sql
[0m20:07:54.145352 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_tables/public/nsc.sql
[0m20:07:54.145663 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_ctes/public/nsc_ab3.sql
[0m20:07:54.168281 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab2.sql
[0m20:07:54.214755 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab2.sql
[0m20:07:54.217055 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_tables/public/nsc.sql
[0m20:07:54.230524 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_tables/public/nsc.sql
[0m20:07:54.232606 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab3.sql
[0m20:07:54.258303 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab3.sql
[0m20:07:54.265446 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_views
- models.airbyte_utils.generated.airbyte_incremental
[0m20:07:54.278374 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m20:07:54.279698 [info ] [MainThread]: 
[0m20:07:54.280421 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:07:54.281331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m20:07:54.290573 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m20:07:54.290850 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m20:07:54.291081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:54.299604 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:07:54.300662 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m20:07:54.302507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m20:07:54.308235 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m20:07:54.308509 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m20:07:54.308736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:54.317994 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:07:54.318414 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m20:07:54.318799 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:07:54.321039 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:07:54.322145 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m20:07:54.322784 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m20:07:54.328376 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:54.328640 [debug] [MainThread]: On master: BEGIN
[0m20:07:54.328860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:54.337855 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:54.338132 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:54.338436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:07:54.345198 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:07:54.346140 [debug] [MainThread]: On master: ROLLBACK
[0m20:07:54.346799 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:54.347054 [debug] [MainThread]: On master: BEGIN
[0m20:07:54.348151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:54.348408 [debug] [MainThread]: On master: COMMIT
[0m20:07:54.348639 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:54.348858 [debug] [MainThread]: On master: COMMIT
[0m20:07:54.349443 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:07:54.349712 [debug] [MainThread]: On master: Close
[0m20:07:54.350492 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m20:07:54.350949 [info ] [MainThread]: 
[0m20:07:54.354438 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m20:07:54.355065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m20:07:54.355405 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m20:07:54.390941 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m20:07:54.391689 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 20:07:54.355604 => 20:07:54.391440
[0m20:07:54.392704 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m20:07:54.393470 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m20:07:54.394176 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m20:07:54.394475 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m20:07:54.441373 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m20:07:54.442221 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 20:07:54.394652 => 20:07:54.441963
[0m20:07:54.443111 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m20:07:54.443947 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m20:07:54.444646 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m20:07:54.444957 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m20:07:54.508565 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m20:07:54.509602 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 20:07:54.445138 => 20:07:54.509323
[0m20:07:54.510474 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m20:07:54.511204 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m20:07:54.511783 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m20:07:54.512552 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m20:07:54.512849 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m20:07:54.530053 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m20:07:54.530644 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 20:07:54.513029 => 20:07:54.530418
[0m20:07:54.530942 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m20:07:54.564434 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m20:07:54.565058 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:07:54.565369 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m20:07:54.565646 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:07:54.574878 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m20:07:54.575200 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:07:54.575809 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "name_suffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast( as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "name_suffix",
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "DegreeMajor4",
    "DegreeMajor3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "RecordFoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m20:07:54.577225 [debug] [Thread-7 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
                                      ^

[0m20:07:54.577553 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: ROLLBACK
[0m20:07:54.578388 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 20:07:54.531125 => 20:07:54.578174
[0m20:07:54.578703 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m20:07:54.580921 [debug] [Thread-7 (]: Database Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)
  syntax error at or near "as"
  LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
                                        ^
  compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m20:07:54.581481 [error] [Thread-7 (]: 1 of 1 ERROR creating sql table model public.nsc ....................................................................... [[31mERROR[0m in 0.07s]
[0m20:07:54.582032 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m20:07:54.583711 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:54.583966 [debug] [MainThread]: On master: BEGIN
[0m20:07:54.584185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:54.592187 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:07:54.592458 [debug] [MainThread]: On master: COMMIT
[0m20:07:54.592697 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:54.592920 [debug] [MainThread]: On master: COMMIT
[0m20:07:54.593478 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:07:54.593735 [debug] [MainThread]: On master: Close
[0m20:07:54.594598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:54.594927 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m20:07:54.595216 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m20:07:54.595565 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m20:07:54.595781 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m20:07:54.595975 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m20:07:54.596211 [info ] [MainThread]: 
[0m20:07:54.596588 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m20:07:54.597121 [debug] [MainThread]: Command end result
[0m20:07:54.607484 [info ] [MainThread]: 
[0m20:07:54.607893 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:07:54.608228 [info ] [MainThread]: 
[0m20:07:54.608553 [error] [MainThread]: [33mDatabase Error in model nsc (models/generated/airbyte_tables/public/nsc.sql)[0m
[0m20:07:54.608871 [error] [MainThread]:   syntax error at or near "as"
[0m20:07:54.609178 [error] [MainThread]:   LINE 130:     md5(cast(coalesce(cast( as text), '') || '-' || coalesce...
[0m20:07:54.609481 [error] [MainThread]:                                         ^
[0m20:07:54.609771 [error] [MainThread]:   compiled Code at target/run/airbyte_utils/models/generated/airbyte_tables/public/nsc.sql
[0m20:07:54.610065 [info ] [MainThread]: 
[0m20:07:54.610429 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:07:54.610987 [debug] [MainThread]: Command `dbt run` failed at 20:07:54.610886 after 0.61 seconds
[0m20:07:54.611259 [debug] [MainThread]: Flushing usage events


============================== 20:09:17.256138 | 3810809f-82ab-4567-9393-d46eb252f3fb ==============================
[0m20:09:17.256138 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:09:17.258511 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m20:09:17.285810 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-do02hnxn'
[0m20:09:17.286426 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m20:09:17.551167 [debug] [MainThread]: STDOUT: "b''"
[0m20:09:17.551584 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m20:09:17.551941 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m20:09:17.552172 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:09:17.553310 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m20:09:17.553540 [debug] [MainThread]: STDERR: "b''"
[0m20:09:17.553750 [debug] [MainThread]: Checking out revision 0.8.2.
[0m20:09:17.553968 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m20:09:17.555248 [debug] [MainThread]: STDOUT: "b''"
[0m20:09:17.555517 [debug] [MainThread]: STDERR: "b''"
[0m20:09:17.555735 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m20:09:17.883080 [debug] [MainThread]: STDOUT: "b''"
[0m20:09:17.883599 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m20:09:17.883958 [debug] [MainThread]: Executing "git tag --list"
[0m20:09:17.885433 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m20:09:17.885685 [debug] [MainThread]: STDERR: "b''"
[0m20:09:17.885908 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m20:09:17.899067 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m20:09:17.899435 [debug] [MainThread]: STDERR: "b''"
[0m20:09:17.899690 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:09:17.900708 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:09:17.900935 [debug] [MainThread]: STDERR: "b''"
[0m20:09:17.901149 [debug] [MainThread]: Checked out at 5717b10.
[0m20:09:17.901846 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m20:09:17.902824 [debug] [MainThread]: STDOUT: "b''"
[0m20:09:17.903053 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m20:09:17.903260 [debug] [MainThread]: command return code=128
[0m20:09:17.903911 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m20:09:17.904135 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:09:17.905140 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:09:17.905363 [debug] [MainThread]: STDERR: "b''"
[0m20:09:17.905567 [debug] [MainThread]: Checking out revision 0.8.2.
[0m20:09:17.905779 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m20:09:17.906998 [debug] [MainThread]: STDOUT: "b''"
[0m20:09:17.907220 [debug] [MainThread]: STDERR: "b''"
[0m20:09:17.907490 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m20:09:18.126308 [debug] [MainThread]: STDOUT: "b''"
[0m20:09:18.126691 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m20:09:18.126927 [debug] [MainThread]: Executing "git tag --list"
[0m20:09:18.128396 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m20:09:18.128640 [debug] [MainThread]: STDERR: "b''"
[0m20:09:18.128860 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m20:09:18.136505 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m20:09:18.136746 [debug] [MainThread]: STDERR: "b''"
[0m20:09:18.136964 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:09:18.137980 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:09:18.138238 [debug] [MainThread]: STDERR: "b''"
[0m20:09:18.138454 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m20:09:18.139200 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m20:09:18.144968 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m20:09:18.145963 [debug] [MainThread]: STDOUT: "b''"
[0m20:09:18.146193 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m20:09:18.146393 [debug] [MainThread]: command return code=128
[0m20:09:18.146827 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m20:09:18.147036 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:09:18.148108 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:09:18.148333 [debug] [MainThread]: STDERR: "b''"
[0m20:09:18.148535 [debug] [MainThread]: Checking out revision 0.8.2.
[0m20:09:18.148742 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m20:09:18.149965 [debug] [MainThread]: STDOUT: "b''"
[0m20:09:18.150187 [debug] [MainThread]: STDERR: "b''"
[0m20:09:18.150398 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m20:09:18.392592 [debug] [MainThread]: STDOUT: "b''"
[0m20:09:18.392982 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m20:09:18.393219 [debug] [MainThread]: Executing "git tag --list"
[0m20:09:18.394700 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m20:09:18.394945 [debug] [MainThread]: STDERR: "b''"
[0m20:09:18.395169 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m20:09:18.400345 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m20:09:18.400576 [debug] [MainThread]: STDERR: "b''"
[0m20:09:18.400787 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:09:18.401789 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:09:18.402010 [debug] [MainThread]: STDERR: "b''"
[0m20:09:18.402213 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m20:09:18.402454 [info ] [MainThread]: Installed from revision 0.8.2
[0m20:09:18.403134 [debug] [MainThread]: Command `dbt deps` succeeded at 20:09:18.403029 after 1.15 seconds
[0m20:09:18.403426 [debug] [MainThread]: Flushing usage events


============================== 20:09:19.909258 | a2a215b6-4a31-4cbe-8744-3fd3db9de08b ==============================
[0m20:09:19.909258 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:09:19.911431 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m20:09:19.997560 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:09:20.049149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:20.049663 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_ctes/public/nsc_ab3.sql
[0m20:09:20.071725 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab3.sql
[0m20:09:20.108074 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab3.sql
[0m20:09:20.115614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_incremental
- models.airbyte_utils.generated.airbyte_views
[0m20:09:20.128950 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m20:09:20.130464 [info ] [MainThread]: 
[0m20:09:20.131324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:09:20.132447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m20:09:20.141867 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m20:09:20.142149 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m20:09:20.142388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:20.153523 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:09:20.154589 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m20:09:20.156463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m20:09:20.161876 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m20:09:20.162148 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m20:09:20.162376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:20.180133 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:09:20.180428 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m20:09:20.180688 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:09:20.182766 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:09:20.183829 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m20:09:20.184467 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m20:09:20.189836 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:20.190098 [debug] [MainThread]: On master: BEGIN
[0m20:09:20.190317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:09:20.198866 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:09:20.199129 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:20.199474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:09:20.206257 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:09:20.211820 [debug] [MainThread]: On master: ROLLBACK
[0m20:09:20.212531 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:20.212785 [debug] [MainThread]: On master: BEGIN
[0m20:09:20.213789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:09:20.214043 [debug] [MainThread]: On master: COMMIT
[0m20:09:20.214274 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:20.214497 [debug] [MainThread]: On master: COMMIT
[0m20:09:20.215114 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:09:20.215402 [debug] [MainThread]: On master: Close
[0m20:09:20.216197 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m20:09:20.216715 [info ] [MainThread]: 
[0m20:09:20.220189 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m20:09:20.220784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m20:09:20.221086 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m20:09:20.258828 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m20:09:20.259499 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 20:09:20.221274 => 20:09:20.259252
[0m20:09:20.260267 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m20:09:20.260991 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m20:09:20.261652 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m20:09:20.261945 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m20:09:20.316155 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m20:09:20.316785 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 20:09:20.262127 => 20:09:20.316555
[0m20:09:20.317547 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m20:09:20.318247 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m20:09:20.318909 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m20:09:20.319200 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m20:09:20.380320 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m20:09:20.380992 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 20:09:20.319416 => 20:09:20.380769
[0m20:09:20.381774 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m20:09:20.382513 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m20:09:20.382942 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m20:09:20.383768 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m20:09:20.384069 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m20:09:20.400390 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m20:09:20.400919 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 20:09:20.384252 => 20:09:20.400705
[0m20:09:20.401209 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m20:09:20.435906 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m20:09:20.436426 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:09:20.436727 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m20:09:20.436996 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:09:20.446101 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m20:09:20.446415 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:09:20.447004 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "name_suffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "DegreeCIP4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "DegreeCIP2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "DegreeCIP3",
    cast("College Code/Branch" as text) as "CollegeCodeBranch",
    cast("First Name" as text) as "FirstName",
    cast("College Name" as text) as "CollegeName",
    cast("Graduated?" as text) as "Graduated",
    cast("Degree Title" as text) as "DegreeTitle",
    cast("Enrollment Major 2" as text) as "EnrollmentMajor2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "DegreeCIP1",
    cast("Enrollment Major 1" as text) as "EnrollmentMajor1",
    cast("Class Level" as text) as "ClassLevel",
    cast("Your Unique Identifier" as text) as "YourUniqueIdentifier",
    cast("Search Date" as 
    bigint
) as "SearchDate",
    cast("College State" as text) as "CollegeState",
    cast("Middle Initial" as text) as "MiddleInitial",
    cast("Enrollment Begin" as DATE ) as "EnrollmentBegin",
    cast("Enrollment Status" as text) as "EnrollmentStatus",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "EnrollmentCIP2",
    cast("Enrollment CIP 1" as 
    float
) as "EnrollmentCIP1",
    cast("Degree Major 4" as text) as "DegreeMajor4",
    cast("Degree Major 3" as text) as "DegreeMajor3",
    cast("Graduation Date" as 
    float
) as "GraduationDate",
    cast("Degree Major 2" as text) as "DegreeMajor2",
    cast("Degree Major 1" as text) as "DegreeMajor1",
    cast("Public / Private" as text) as "PublicPrivate",
    cast("Enrollment End" as DATE ) as "EnrollmentEnd",
    cast("Last Name" as text) as "LastName",
    cast("2-year / 4-year" as text) as "2-year4-year",
    cast("Record Found Y/N" as text) as "RecordFoundYN",
    cast("College Sequence" as 
    float
) as "CollegeSequence",
    cast("Requester Return Field" as 
    bigint
) as "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("name_suffix" as text), '') || '-' || coalesce(cast("DegreeCIP4" as text), '') || '-' || coalesce(cast("DegreeCIP2" as text), '') || '-' || coalesce(cast("DegreeCIP3" as text), '') || '-' || coalesce(cast("CollegeCodeBranch" as text), '') || '-' || coalesce(cast("FirstName" as text), '') || '-' || coalesce(cast("CollegeName" as text), '') || '-' || coalesce(cast("Graduated" as text), '') || '-' || coalesce(cast("DegreeTitle" as text), '') || '-' || coalesce(cast("EnrollmentMajor2" as text), '') || '-' || coalesce(cast("DegreeCIP1" as text), '') || '-' || coalesce(cast("EnrollmentMajor1" as text), '') || '-' || coalesce(cast("ClassLevel" as text), '') || '-' || coalesce(cast("YourUniqueIdentifier" as text), '') || '-' || coalesce(cast("SearchDate" as text), '') || '-' || coalesce(cast("CollegeState" as text), '') || '-' || coalesce(cast("MiddleInitial" as text), '') || '-' || coalesce(cast("EnrollmentBegin" as text), '') || '-' || coalesce(cast("EnrollmentStatus" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("EnrollmentCIP2" as text), '') || '-' || coalesce(cast("EnrollmentCIP1" as text), '') || '-' || coalesce(cast("DegreeMajor4" as text), '') || '-' || coalesce(cast("DegreeMajor3" as text), '') || '-' || coalesce(cast("GraduationDate" as text), '') || '-' || coalesce(cast("DegreeMajor2" as text), '') || '-' || coalesce(cast("DegreeMajor1" as text), '') || '-' || coalesce(cast("PublicPrivate" as text), '') || '-' || coalesce(cast("EnrollmentEnd" as text), '') || '-' || coalesce(cast("LastName" as text), '') || '-' || coalesce(cast("2-year4-year" as text), '') || '-' || coalesce(cast("RecordFoundYN" as text), '') || '-' || coalesce(cast("CollegeSequence" as text), '') || '-' || coalesce(cast("RequesterReturnField" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "name_suffix",
    "DegreeCIP4",
    "DegreeCIP2",
    "DegreeCIP3",
    "CollegeCodeBranch",
    "FirstName",
    "CollegeName",
    "Graduated",
    "DegreeTitle",
    "EnrollmentMajor2",
    "DegreeCIP1",
    "EnrollmentMajor1",
    "ClassLevel",
    "YourUniqueIdentifier",
    "SearchDate",
    "CollegeState",
    "MiddleInitial",
    "EnrollmentBegin",
    "EnrollmentStatus",
    last_modified,
    "EnrollmentCIP2",
    "EnrollmentCIP1",
    "DegreeMajor4",
    "DegreeMajor3",
    "GraduationDate",
    "DegreeMajor2",
    "DegreeMajor1",
    "PublicPrivate",
    "EnrollmentEnd",
    "LastName",
    "2-year4-year",
    "RecordFoundYN",
    "CollegeSequence",
    "RequesterReturnField",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m20:09:23.779535 [debug] [Thread-7 (]: SQL status: SELECT 197245 in 3.0 seconds
[0m20:09:23.786196 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:09:23.786555 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging"."public"."nsc" rename to "nsc__dbt_backup"
[0m20:09:23.787540 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:09:23.790758 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:09:23.791067 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging".public."nsc__dbt_tmp" rename to "nsc"
[0m20:09:23.791950 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:09:23.802606 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:09:23.802930 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

    create  index if not exists
  "d6da95b02c02e06a1acaa97db47ca05b"
  on "datahub_staging".public."nsc" using btree
  (_airbyte_emitted_at);
  
[0m20:09:23.895962 [debug] [Thread-7 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:09:23.913768 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m20:09:23.914160 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:09:23.914452 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m20:09:23.933522 [debug] [Thread-7 (]: SQL status: COMMIT in 0.0 seconds
[0m20:09:23.938838 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:09:23.939162 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
drop table if exists "datahub_staging".public."nsc__dbt_backup" cascade
[0m20:09:23.948679 [debug] [Thread-7 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:09:23.950169 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 20:09:20.401393 => 20:09:23.949972
[0m20:09:23.950493 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m20:09:23.951788 [info ] [Thread-7 (]: 1 of 1 OK created sql table model public.nsc ........................................................................... [[32mSELECT 197245[0m in 3.57s]
[0m20:09:23.952605 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m20:09:23.954524 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:23.954846 [debug] [MainThread]: On master: BEGIN
[0m20:09:23.955120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:23.963440 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:09:23.963721 [debug] [MainThread]: On master: COMMIT
[0m20:09:23.963958 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:23.964185 [debug] [MainThread]: On master: COMMIT
[0m20:09:23.964617 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:09:23.964871 [debug] [MainThread]: On master: Close
[0m20:09:23.965656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:23.965983 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m20:09:23.966282 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m20:09:23.966556 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m20:09:23.966868 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m20:09:23.967169 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m20:09:23.967576 [info ] [MainThread]: 
[0m20:09:23.968181 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m20:09:23.968927 [debug] [MainThread]: Command end result
[0m20:09:23.979737 [info ] [MainThread]: 
[0m20:09:23.980323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:09:23.980672 [info ] [MainThread]: 
[0m20:09:23.981028 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:09:23.981602 [debug] [MainThread]: Command `dbt run` succeeded at 20:09:23.981497 after 4.08 seconds
[0m20:09:23.981877 [debug] [MainThread]: Flushing usage events


============================== 20:32:34.346696 | 33366920-f535-401f-a95a-aa89f1866339 ==============================
[0m20:32:34.346696 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:32:34.349045 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m20:32:34.375269 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0e481xav'
[0m20:32:34.375772 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m20:32:34.608924 [debug] [MainThread]: STDOUT: "b''"
[0m20:32:34.609316 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m20:32:34.609676 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m20:32:34.609911 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:32:34.611030 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m20:32:34.611261 [debug] [MainThread]: STDERR: "b''"
[0m20:32:34.611566 [debug] [MainThread]: Checking out revision 0.8.2.
[0m20:32:34.611799 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m20:32:34.613088 [debug] [MainThread]: STDOUT: "b''"
[0m20:32:34.613318 [debug] [MainThread]: STDERR: "b''"
[0m20:32:34.613538 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m20:32:34.930822 [debug] [MainThread]: STDOUT: "b''"
[0m20:32:34.931327 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m20:32:34.931723 [debug] [MainThread]: Executing "git tag --list"
[0m20:32:34.933217 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m20:32:34.933467 [debug] [MainThread]: STDERR: "b''"
[0m20:32:34.933689 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m20:32:34.945215 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m20:32:34.945459 [debug] [MainThread]: STDERR: "b''"
[0m20:32:34.945688 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:32:34.946727 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:32:34.946966 [debug] [MainThread]: STDERR: "b''"
[0m20:32:34.947177 [debug] [MainThread]: Checked out at 5717b10.
[0m20:32:34.947935 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m20:32:34.948919 [debug] [MainThread]: STDOUT: "b''"
[0m20:32:34.949152 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m20:32:34.949356 [debug] [MainThread]: command return code=128
[0m20:32:34.949959 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m20:32:34.950179 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:32:34.951185 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:32:34.951454 [debug] [MainThread]: STDERR: "b''"
[0m20:32:34.951665 [debug] [MainThread]: Checking out revision 0.8.2.
[0m20:32:34.951877 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m20:32:34.953127 [debug] [MainThread]: STDOUT: "b''"
[0m20:32:34.953352 [debug] [MainThread]: STDERR: "b''"
[0m20:32:34.953565 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m20:32:35.170662 [debug] [MainThread]: STDOUT: "b''"
[0m20:32:35.171060 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m20:32:35.171303 [debug] [MainThread]: Executing "git tag --list"
[0m20:32:35.172809 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m20:32:35.173056 [debug] [MainThread]: STDERR: "b''"
[0m20:32:35.173277 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m20:32:35.181792 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m20:32:35.182027 [debug] [MainThread]: STDERR: "b''"
[0m20:32:35.182245 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:32:35.183267 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:32:35.183526 [debug] [MainThread]: STDERR: "b''"
[0m20:32:35.183738 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m20:32:35.184484 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m20:32:35.190276 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m20:32:35.191282 [debug] [MainThread]: STDOUT: "b''"
[0m20:32:35.191636 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m20:32:35.191856 [debug] [MainThread]: command return code=128
[0m20:32:35.192295 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m20:32:35.192579 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:32:35.193607 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:32:35.193831 [debug] [MainThread]: STDERR: "b''"
[0m20:32:35.194034 [debug] [MainThread]: Checking out revision 0.8.2.
[0m20:32:35.194239 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m20:32:35.195524 [debug] [MainThread]: STDOUT: "b''"
[0m20:32:35.195758 [debug] [MainThread]: STDERR: "b''"
[0m20:32:35.195973 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m20:32:35.400582 [debug] [MainThread]: STDOUT: "b''"
[0m20:32:35.400975 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m20:32:35.401215 [debug] [MainThread]: Executing "git tag --list"
[0m20:32:35.402667 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m20:32:35.402919 [debug] [MainThread]: STDERR: "b''"
[0m20:32:35.403138 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m20:32:35.409265 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m20:32:35.409549 [debug] [MainThread]: STDERR: "b''"
[0m20:32:35.409810 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m20:32:35.410900 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m20:32:35.411126 [debug] [MainThread]: STDERR: "b''"
[0m20:32:35.411336 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m20:32:35.411627 [info ] [MainThread]: Installed from revision 0.8.2
[0m20:32:35.412306 [debug] [MainThread]: Command `dbt deps` succeeded at 20:32:35.412198 after 1.07 seconds
[0m20:32:35.412566 [debug] [MainThread]: Flushing usage events


============================== 20:32:36.896819 | c32f62e9-0812-4330-afae-05ff02034a3f ==============================
[0m20:32:36.896819 [info ] [MainThread]: Running with dbt=1.5.0
[0m20:32:36.899014 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/azureuser/nsc/normalization-files/normalize/logs', 'debug': 'False', 'profiles_dir': '/home/azureuser/nsc//normalization-files/normalize', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m20:32:36.985485 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m20:32:37.037191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:32:37.037709 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_tables/public/nsc.sql
[0m20:32:37.038042 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_ctes/public/nsc_ab3.sql
[0m20:32:37.038351 [debug] [MainThread]: Partial parsing: updated file: airbyte_utils://models/generated/airbyte_ctes/public/nsc_ab2.sql
[0m20:32:37.059853 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_tables/public/nsc.sql
[0m20:32:37.083271 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_tables/public/nsc.sql
[0m20:32:37.085440 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab3.sql
[0m20:32:37.113081 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab3.sql
[0m20:32:37.115957 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab2.sql
[0m20:32:37.151593 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab2.sql
[0m20:32:37.159003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_views
- models.airbyte_utils.generated.airbyte_incremental
[0m20:32:37.172342 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m20:32:37.173661 [info ] [MainThread]: 
[0m20:32:37.174374 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:32:37.175298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m20:32:37.184583 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m20:32:37.184865 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m20:32:37.185100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:37.195237 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:32:37.196359 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m20:32:37.198151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m20:32:37.203758 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m20:32:37.204028 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m20:32:37.204249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:37.222620 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:32:37.222890 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m20:32:37.223138 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:32:37.225224 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:32:37.226338 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m20:32:37.226990 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m20:32:37.232400 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:37.232661 [debug] [MainThread]: On master: BEGIN
[0m20:32:37.232879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:32:37.241196 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:32:37.241458 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:37.241760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:32:37.248414 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:32:37.249333 [debug] [MainThread]: On master: ROLLBACK
[0m20:32:37.249980 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:37.250227 [debug] [MainThread]: On master: BEGIN
[0m20:32:37.251148 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:32:37.251457 [debug] [MainThread]: On master: COMMIT
[0m20:32:37.251702 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:37.251920 [debug] [MainThread]: On master: COMMIT
[0m20:32:37.252523 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:32:37.252778 [debug] [MainThread]: On master: Close
[0m20:32:37.253574 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m20:32:37.254019 [info ] [MainThread]: 
[0m20:32:37.257456 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m20:32:37.258058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m20:32:37.258356 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m20:32:37.293518 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m20:32:37.294123 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 20:32:37.258595 => 20:32:37.293902
[0m20:32:37.295126 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m20:32:37.295836 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m20:32:37.296520 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m20:32:37.296808 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m20:32:37.343069 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m20:32:37.343898 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 20:32:37.296986 => 20:32:37.343643
[0m20:32:37.344786 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m20:32:37.345603 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m20:32:37.346354 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m20:32:37.346653 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m20:32:37.409002 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m20:32:37.409769 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 20:32:37.346831 => 20:32:37.409517
[0m20:32:37.410606 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m20:32:37.411329 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m20:32:37.411924 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m20:32:37.412722 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m20:32:37.413011 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m20:32:37.429685 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m20:32:37.430246 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 20:32:37.413188 => 20:32:37.430027
[0m20:32:37.430540 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m20:32:37.465194 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m20:32:37.465735 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:32:37.466042 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m20:32:37.466310 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:32:37.473597 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m20:32:37.473915 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:32:37.474484 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "name_suffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "degree_cip_4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "degree_cip_2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "degree_cip_3",
    cast("College Code/Branch" as text) as "college_code_branch",
    cast("First Name" as text) as "first_name",
    cast("College Name" as text) as "college_name",
    cast("Graduated?" as text) as "graduated",
    cast("Degree Title" as text) as "degree_title",
    cast("Enrollment Major 2" as text) as "enrollment_major_2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "degree_cip_1",
    cast("Enrollment Major 1" as text) as "enrollment_major_1",
    cast("Class Level" as text) as "class_level",
    cast("Your Unique Identifier" as text) as "your_unique_identifier",
    cast("Search Date" as 
    bigint
) as "search_date",
    cast("College State" as text) as "college_state",
    cast("Middle Initial" as text) as "middle_initial",
    cast("Enrollment Begin" as DATE ) as "enrollment_begin",
    cast("Enrollment Status" as text) as "enrollment_status",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "enrollment_cip_2",
    cast("Enrollment CIP 1" as 
    float
) as "enrollment_cip_1",
    cast("Degree Major 4" as text) as "degree_major_4",
    cast("Degree Major 3" as text) as "degree_major_3",
    cast("Graduation Date" as 
    float
) as "graduation_date",
    cast("Degree Major 2" as text) as "degree_major_2",
    cast("Degree Major 1" as text) as "degree_major_1",
    cast("Public / Private" as text) as "public_private",
    cast("Enrollment End" as DATE ) as "enrollment_end",
    cast("Last Name" as text) as "last_name",
    cast("2-year / 4-year" as text) as "2-year_4-year",
    cast("Record Found Y/N" as text) as "record_found_yn",
    cast("College Sequence" as 
    float
) as "college_sequence",
    cast("Requester Return Field" as 
    bigint
) as "requester_return_field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("name_suffix" as text), '') || '-' || coalesce(cast("degree_cip_4" as text), '') || '-' || coalesce(cast("degree_cip_2" as text), '') || '-' || coalesce(cast("degree_cip_3" as text), '') || '-' || coalesce(cast("college_code_branch" as text), '') || '-' || coalesce(cast("first_name" as text), '') || '-' || coalesce(cast("college_name" as text), '') || '-' || coalesce(cast("graduated" as text), '') || '-' || coalesce(cast("degree_title" as text), '') || '-' || coalesce(cast("enrollment_major_2" as text), '') || '-' || coalesce(cast("degree_cip_1" as text), '') || '-' || coalesce(cast("enrollment_major_1" as text), '') || '-' || coalesce(cast("class_level" as text), '') || '-' || coalesce(cast("your_unique_identifier" as text), '') || '-' || coalesce(cast("search_date" as text), '') || '-' || coalesce(cast("college_state" as text), '') || '-' || coalesce(cast("middle_initial" as text), '') || '-' || coalesce(cast("enrollment_begin" as text), '') || '-' || coalesce(cast("enrollment_status" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("enrollment_cip_2" as text), '') || '-' || coalesce(cast("enrollment_cip_1" as text), '') || '-' || coalesce(cast("degree_major_4" as text), '') || '-' || coalesce(cast("degree_major_3" as text), '') || '-' || coalesce(cast("graduation_date" as text), '') || '-' || coalesce(cast("degree_major_2" as text), '') || '-' || coalesce(cast("degree_major_1" as text), '') || '-' || coalesce(cast("public_private" as text), '') || '-' || coalesce(cast("enrollment_end" as text), '') || '-' || coalesce(cast("last_name" as text), '') || '-' || coalesce(cast("2-year_4-year" as text), '') || '-' || coalesce(cast("record_found_yn" as text), '') || '-' || coalesce(cast("college_sequence" as text), '') || '-' || coalesce(cast("requester_return_field" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "name_suffix",
    "degree_cip_4",
    "degree_cip_2",
    "degree_cip_3",
    "college_code_branch",
    "first_name",
    "college_name",
    "graduated",
    "degree_title",
    "enrollment_major_2",
    "degree_cip_1",
    "enrollment_major_1",
    "class_level",
    "your_unique_identifier",
    "search_date",
    "college_state",
    "middle_initial",
    "enrollment_begin",
    "enrollment_status",
    last_modified,
    "enrollment_cip_2",
    "enrollment_cip_1",
    "degree_major_4",
    "degree_major_3",
    "graduation_date",
    "degree_major_2",
    "degree_major_1",
    "public_private",
    "enrollment_end",
    "last_name",
    "2-year_4-year",
    "record_found_yn",
    "college_sequence",
    "requester_return_field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m20:32:40.834598 [debug] [Thread-7 (]: SQL status: SELECT 197245 in 3.0 seconds
[0m20:32:40.842550 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:32:40.842938 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging"."public"."nsc" rename to "nsc__dbt_backup"
[0m20:32:40.843727 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:32:40.846815 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:32:40.847142 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging".public."nsc__dbt_tmp" rename to "nsc"
[0m20:32:40.847831 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:32:40.858656 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:32:40.859003 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

    create  index if not exists
  "bd285d784dd8e80745609af55f1a1334"
  on "datahub_staging".public."nsc" using btree
  (_airbyte_emitted_at);
  
[0m20:32:40.949685 [debug] [Thread-7 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:32:40.968028 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m20:32:40.968404 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:32:40.968688 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m20:32:40.982784 [debug] [Thread-7 (]: SQL status: COMMIT in 0.0 seconds
[0m20:32:40.988185 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m20:32:40.988506 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
drop table if exists "datahub_staging".public."nsc__dbt_backup" cascade
[0m20:32:40.998089 [debug] [Thread-7 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:32:40.999451 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 20:32:37.430717 => 20:32:40.999238
[0m20:32:40.999769 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m20:32:41.000970 [info ] [Thread-7 (]: 1 of 1 OK created sql table model public.nsc ........................................................................... [[32mSELECT 197245[0m in 3.59s]
[0m20:32:41.001790 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m20:32:41.003681 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:41.004011 [debug] [MainThread]: On master: BEGIN
[0m20:32:41.004285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:32:41.011833 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:32:41.012102 [debug] [MainThread]: On master: COMMIT
[0m20:32:41.012339 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:41.012561 [debug] [MainThread]: On master: COMMIT
[0m20:32:41.012960 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:32:41.013214 [debug] [MainThread]: On master: Close
[0m20:32:41.013967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:41.014291 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m20:32:41.014588 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m20:32:41.014855 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m20:32:41.015143 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m20:32:41.015388 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m20:32:41.015650 [info ] [MainThread]: 
[0m20:32:41.015996 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m20:32:41.016596 [debug] [MainThread]: Command end result
[0m20:32:41.026203 [info ] [MainThread]: 
[0m20:32:41.026605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:32:41.026942 [info ] [MainThread]: 
[0m20:32:41.027291 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:32:41.027880 [debug] [MainThread]: Command `dbt run` succeeded at 20:32:41.027780 after 4.14 seconds
[0m20:32:41.028140 [debug] [MainThread]: Flushing usage events


============================== 14:05:18.405668 | 34d40874-669f-4091-9cb1-5ec4aa52da67 ==============================
[0m14:05:18.405668 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:05:18.408519 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/dbt-normalize/nsc', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/azureuser/dbt-normalize/nsc/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m14:05:18.434908 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pk2y4o9r'
[0m14:05:18.435375 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m14:05:18.703583 [debug] [MainThread]: STDOUT: "b''"
[0m14:05:18.703973 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m14:05:18.704335 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m14:05:18.704565 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:05:18.706295 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m14:05:18.706659 [debug] [MainThread]: STDERR: "b''"
[0m14:05:18.706896 [debug] [MainThread]: Checking out revision 0.8.2.
[0m14:05:18.707119 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m14:05:18.708500 [debug] [MainThread]: STDOUT: "b''"
[0m14:05:18.708729 [debug] [MainThread]: STDERR: "b''"
[0m14:05:18.708947 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m14:05:19.109890 [debug] [MainThread]: STDOUT: "b''"
[0m14:05:19.110368 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m14:05:19.110740 [debug] [MainThread]: Executing "git tag --list"
[0m14:05:19.112207 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m14:05:19.112458 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.112677 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m14:05:19.124275 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m14:05:19.124516 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.124735 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:05:19.125799 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:05:19.126026 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.126236 [debug] [MainThread]: Checked out at 5717b10.
[0m14:05:19.126918 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m14:05:19.127896 [debug] [MainThread]: STDOUT: "b''"
[0m14:05:19.128126 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m14:05:19.128337 [debug] [MainThread]: command return code=128
[0m14:05:19.128933 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m14:05:19.129152 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:05:19.130240 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:05:19.130463 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.130667 [debug] [MainThread]: Checking out revision 0.8.2.
[0m14:05:19.130872 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m14:05:19.132110 [debug] [MainThread]: STDOUT: "b''"
[0m14:05:19.132331 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.132541 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m14:05:19.366774 [debug] [MainThread]: STDOUT: "b''"
[0m14:05:19.367160 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m14:05:19.367403 [debug] [MainThread]: Executing "git tag --list"
[0m14:05:19.368867 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m14:05:19.369124 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.369358 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m14:05:19.377453 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m14:05:19.377786 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.378017 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:05:19.379032 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:05:19.379255 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.379464 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m14:05:19.380199 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m14:05:19.380587 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m14:05:19.381546 [debug] [MainThread]: STDOUT: "b''"
[0m14:05:19.381798 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m14:05:19.382007 [debug] [MainThread]: command return code=128
[0m14:05:19.382453 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m14:05:19.382671 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:05:19.383665 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:05:19.383887 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.384087 [debug] [MainThread]: Checking out revision 0.8.2.
[0m14:05:19.384293 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m14:05:19.385574 [debug] [MainThread]: STDOUT: "b''"
[0m14:05:19.385924 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.386145 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m14:05:19.674288 [debug] [MainThread]: STDOUT: "b''"
[0m14:05:19.674694 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m14:05:19.674942 [debug] [MainThread]: Executing "git tag --list"
[0m14:05:19.676422 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m14:05:19.676675 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.676903 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m14:05:19.685297 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m14:05:19.685629 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.686030 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:05:19.687447 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:05:19.687683 [debug] [MainThread]: STDERR: "b''"
[0m14:05:19.687927 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m14:05:19.688183 [info ] [MainThread]: Installed from revision 0.8.2
[0m14:05:19.689064 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:19.688776 after 1.29 seconds
[0m14:05:19.690074 [debug] [MainThread]: Flushing usage events


============================== 14:05:21.193128 | e5217bfd-c394-4ac0-840b-5138cb5a4464 ==============================
[0m14:05:21.193128 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:05:21.195374 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/azureuser/dbt-normalize/nsc/logs', 'profiles_dir': '/home/azureuser/dbt-normalize/nsc', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m14:05:21.300071 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:05:21.361304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:21.361652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:21.362149 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_incremental
- models.airbyte_utils.generated.airbyte_views
[0m14:05:21.377569 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:05:21.378875 [info ] [MainThread]: 
[0m14:05:21.379596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:21.380508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m14:05:21.389933 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m14:05:21.390214 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m14:05:21.390450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:21.406084 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:05:21.407116 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m14:05:21.409264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m14:05:21.414602 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m14:05:21.414868 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m14:05:21.415095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:21.421858 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:05:21.422125 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m14:05:21.422377 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:05:21.426868 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:05:21.427973 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m14:05:21.428411 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m14:05:21.433534 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:21.433847 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.434086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:21.442212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:21.442480 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:21.442795 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:21.451210 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:05:21.452105 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:21.452710 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:21.452962 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.453877 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:21.454133 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.454390 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:21.454611 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.455265 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:05:21.455519 [debug] [MainThread]: On master: Close
[0m14:05:21.456340 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m14:05:21.456877 [info ] [MainThread]: 
[0m14:05:21.461353 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m14:05:21.461968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m14:05:21.462270 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m14:05:21.498359 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m14:05:21.499494 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 14:05:21.462456 => 14:05:21.499250
[0m14:05:21.500246 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m14:05:21.500953 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m14:05:21.501623 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m14:05:21.501951 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m14:05:21.558827 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m14:05:21.559556 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 14:05:21.502133 => 14:05:21.559308
[0m14:05:21.560322 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m14:05:21.561062 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m14:05:21.561789 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m14:05:21.562087 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m14:05:21.632571 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m14:05:21.633230 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 14:05:21.562269 => 14:05:21.632989
[0m14:05:21.634225 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m14:05:21.634962 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m14:05:21.635376 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m14:05:21.636137 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m14:05:21.636428 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m14:05:21.655543 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m14:05:21.656575 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 14:05:21.636604 => 14:05:21.656263
[0m14:05:21.657118 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m14:05:21.695499 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m14:05:21.696484 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:05:21.696793 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m14:05:21.697074 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m14:05:21.704318 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m14:05:21.704636 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:05:21.705205 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "name_suffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "degree_cip_4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "degree_cip_2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "degree_cip_3",
    cast("College Code/Branch" as text) as "college_code_branch",
    cast("First Name" as text) as "first_name",
    cast("College Name" as text) as "college_name",
    cast("Graduated?" as text) as "graduated",
    cast("Degree Title" as text) as "degree_title",
    cast("Enrollment Major 2" as text) as "enrollment_major_2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "degree_cip_1",
    cast("Enrollment Major 1" as text) as "enrollment_major_1",
    cast("Class Level" as text) as "class_level",
    cast("Your Unique Identifier" as text) as "your_unique_identifier",
    cast("Search Date" as 
    bigint
) as "search_date",
    cast("College State" as text) as "college_state",
    cast("Middle Initial" as text) as "middle_initial",
    cast("Enrollment Begin" as DATE ) as "enrollment_begin",
    cast("Enrollment Status" as text) as "enrollment_status",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "enrollment_cip_2",
    cast("Enrollment CIP 1" as 
    float
) as "enrollment_cip_1",
    cast("Degree Major 4" as text) as "degree_major_4",
    cast("Degree Major 3" as text) as "degree_major_3",
    cast("Graduation Date" as 
    float
) as "graduation_date",
    cast("Degree Major 2" as text) as "degree_major_2",
    cast("Degree Major 1" as text) as "degree_major_1",
    cast("Public / Private" as text) as "public_private",
    cast("Enrollment End" as DATE ) as "enrollment_end",
    cast("Last Name" as text) as "last_name",
    cast("2-year / 4-year" as text) as "2-year_4-year",
    cast("Record Found Y/N" as text) as "record_found_yn",
    cast("College Sequence" as 
    float
) as "college_sequence",
    cast("Requester Return Field" as 
    bigint
) as "requester_return_field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("name_suffix" as text), '') || '-' || coalesce(cast("degree_cip_4" as text), '') || '-' || coalesce(cast("degree_cip_2" as text), '') || '-' || coalesce(cast("degree_cip_3" as text), '') || '-' || coalesce(cast("college_code_branch" as text), '') || '-' || coalesce(cast("first_name" as text), '') || '-' || coalesce(cast("college_name" as text), '') || '-' || coalesce(cast("graduated" as text), '') || '-' || coalesce(cast("degree_title" as text), '') || '-' || coalesce(cast("enrollment_major_2" as text), '') || '-' || coalesce(cast("degree_cip_1" as text), '') || '-' || coalesce(cast("enrollment_major_1" as text), '') || '-' || coalesce(cast("class_level" as text), '') || '-' || coalesce(cast("your_unique_identifier" as text), '') || '-' || coalesce(cast("search_date" as text), '') || '-' || coalesce(cast("college_state" as text), '') || '-' || coalesce(cast("middle_initial" as text), '') || '-' || coalesce(cast("enrollment_begin" as text), '') || '-' || coalesce(cast("enrollment_status" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("enrollment_cip_2" as text), '') || '-' || coalesce(cast("enrollment_cip_1" as text), '') || '-' || coalesce(cast("degree_major_4" as text), '') || '-' || coalesce(cast("degree_major_3" as text), '') || '-' || coalesce(cast("graduation_date" as text), '') || '-' || coalesce(cast("degree_major_2" as text), '') || '-' || coalesce(cast("degree_major_1" as text), '') || '-' || coalesce(cast("public_private" as text), '') || '-' || coalesce(cast("enrollment_end" as text), '') || '-' || coalesce(cast("last_name" as text), '') || '-' || coalesce(cast("2-year_4-year" as text), '') || '-' || coalesce(cast("record_found_yn" as text), '') || '-' || coalesce(cast("college_sequence" as text), '') || '-' || coalesce(cast("requester_return_field" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "name_suffix",
    "degree_cip_4",
    "degree_cip_2",
    "degree_cip_3",
    "college_code_branch",
    "first_name",
    "college_name",
    "graduated",
    "degree_title",
    "enrollment_major_2",
    "degree_cip_1",
    "enrollment_major_1",
    "class_level",
    "your_unique_identifier",
    "search_date",
    "college_state",
    "middle_initial",
    "enrollment_begin",
    "enrollment_status",
    last_modified,
    "enrollment_cip_2",
    "enrollment_cip_1",
    "degree_major_4",
    "degree_major_3",
    "graduation_date",
    "degree_major_2",
    "degree_major_1",
    "public_private",
    "enrollment_end",
    "last_name",
    "2-year_4-year",
    "record_found_yn",
    "college_sequence",
    "requester_return_field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m14:05:25.166166 [debug] [Thread-7 (]: SQL status: SELECT 197245 in 3.0 seconds
[0m14:05:25.172642 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:05:25.172979 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging"."public"."nsc" rename to "nsc__dbt_backup"
[0m14:05:25.173793 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:05:25.176630 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:05:25.176935 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging".public."nsc__dbt_tmp" rename to "nsc"
[0m14:05:25.177538 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:05:25.188138 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:05:25.188469 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

    create  index if not exists
  "c81df11beefda0993cae6ff489edd812"
  on "datahub_staging".public."nsc" using btree
  (_airbyte_emitted_at);
  
[0m14:05:25.279616 [debug] [Thread-7 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m14:05:25.298261 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m14:05:25.298617 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:05:25.298902 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m14:05:25.310477 [debug] [Thread-7 (]: SQL status: COMMIT in 0.0 seconds
[0m14:05:25.315508 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:05:25.315823 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
drop table if exists "datahub_staging".public."nsc__dbt_backup" cascade
[0m14:05:25.322312 [debug] [Thread-7 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:05:25.323689 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 14:05:21.657452 => 14:05:25.323494
[0m14:05:25.324002 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m14:05:25.325110 [info ] [Thread-7 (]: 1 of 1 OK created sql table model public.nsc ........................................................................... [[32mSELECT 197245[0m in 3.69s]
[0m14:05:25.326040 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m14:05:25.327860 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:25.328178 [debug] [MainThread]: On master: BEGIN
[0m14:05:25.328478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:25.337566 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:05:25.337871 [debug] [MainThread]: On master: COMMIT
[0m14:05:25.338114 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:25.338340 [debug] [MainThread]: On master: COMMIT
[0m14:05:25.338995 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:05:25.339249 [debug] [MainThread]: On master: Close
[0m14:05:25.339814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:25.340045 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m14:05:25.340438 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m14:05:25.340743 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m14:05:25.341036 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m14:05:25.341306 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m14:05:25.341649 [info ] [MainThread]: 
[0m14:05:25.342027 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m14:05:25.342635 [debug] [MainThread]: Command end result
[0m14:05:25.351200 [info ] [MainThread]: 
[0m14:05:25.351585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:25.351912 [info ] [MainThread]: 
[0m14:05:25.352252 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:25.352795 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:25.352696 after 4.17 seconds
[0m14:05:25.353051 [debug] [MainThread]: Flushing usage events


============================== 14:43:06.557145 | 9dbdc715-4b86-4e89-acee-dcd7dd8c6f8d ==============================
[0m14:43:06.557145 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:43:06.559321 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/azureuser/dbt-normalize/nsc/logs', 'fail_fast': 'False', 'profiles_dir': '/home/azureuser/dbt-normalize/nsc', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m14:43:06.586658 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_w2f6k4i'
[0m14:43:06.587100 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m14:43:06.829877 [debug] [MainThread]: STDOUT: "b''"
[0m14:43:06.830281 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m14:43:06.830660 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m14:43:06.830902 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:43:06.832121 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m14:43:06.832359 [debug] [MainThread]: STDERR: "b''"
[0m14:43:06.832577 [debug] [MainThread]: Checking out revision 0.8.2.
[0m14:43:06.832808 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m14:43:06.834227 [debug] [MainThread]: STDOUT: "b''"
[0m14:43:06.834459 [debug] [MainThread]: STDERR: "b''"
[0m14:43:06.834678 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m14:43:07.174065 [debug] [MainThread]: STDOUT: "b''"
[0m14:43:07.174571 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m14:43:07.174919 [debug] [MainThread]: Executing "git tag --list"
[0m14:43:07.176398 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m14:43:07.176647 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.176865 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m14:43:07.189687 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m14:43:07.190011 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.190234 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:43:07.191265 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:43:07.191496 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.191705 [debug] [MainThread]: Checked out at 5717b10.
[0m14:43:07.192397 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m14:43:07.193384 [debug] [MainThread]: STDOUT: "b''"
[0m14:43:07.193613 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m14:43:07.193896 [debug] [MainThread]: command return code=128
[0m14:43:07.194506 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m14:43:07.194726 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:43:07.195736 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:43:07.195961 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.196165 [debug] [MainThread]: Checking out revision 0.8.2.
[0m14:43:07.196374 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m14:43:07.197586 [debug] [MainThread]: STDOUT: "b''"
[0m14:43:07.198036 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.198264 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m14:43:07.441624 [debug] [MainThread]: STDOUT: "b''"
[0m14:43:07.442046 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m14:43:07.442313 [debug] [MainThread]: Executing "git tag --list"
[0m14:43:07.443846 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m14:43:07.444099 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.444324 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m14:43:07.451046 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m14:43:07.451283 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.451503 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:43:07.452551 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:43:07.452775 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.452981 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m14:43:07.453714 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m14:43:07.454155 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m14:43:07.455144 [debug] [MainThread]: STDOUT: "b''"
[0m14:43:07.455371 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m14:43:07.455569 [debug] [MainThread]: command return code=128
[0m14:43:07.456007 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m14:43:07.456211 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:43:07.457230 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:43:07.457454 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.457654 [debug] [MainThread]: Checking out revision 0.8.2.
[0m14:43:07.458022 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m14:43:07.459264 [debug] [MainThread]: STDOUT: "b''"
[0m14:43:07.459485 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.459697 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m14:43:07.793671 [debug] [MainThread]: STDOUT: "b''"
[0m14:43:07.794067 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m14:43:07.794302 [debug] [MainThread]: Executing "git tag --list"
[0m14:43:07.795749 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m14:43:07.795991 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.796206 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m14:43:07.802919 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m14:43:07.803150 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.803361 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:43:07.804385 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:43:07.804609 [debug] [MainThread]: STDERR: "b''"
[0m14:43:07.804811 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m14:43:07.805047 [info ] [MainThread]: Installed from revision 0.8.2
[0m14:43:07.805783 [debug] [MainThread]: Command `dbt deps` succeeded at 14:43:07.805643 after 1.26 seconds
[0m14:43:07.806053 [debug] [MainThread]: Flushing usage events


============================== 14:43:09.274379 | 3be60599-ca8f-4459-ac18-d641f296a8a3 ==============================
[0m14:43:09.274379 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:43:09.276562 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/azureuser/dbt-normalize/nsc', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/azureuser/dbt-normalize/nsc/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m14:43:09.362338 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:43:09.411119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:43:09.411442 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:43:09.411886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_incremental
- models.airbyte_utils.generated.airbyte_views
[0m14:43:09.426947 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:43:09.428188 [info ] [MainThread]: 
[0m14:43:09.428882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:43:09.429791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m14:43:09.439240 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m14:43:09.439513 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m14:43:09.439744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:09.452199 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:43:09.453650 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m14:43:09.455402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datahub_staging, now list_datahub_staging_public)
[0m14:43:09.460832 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m14:43:09.461100 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m14:43:09.461325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:09.469546 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:43:09.469854 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m14:43:09.470104 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:43:09.472357 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:43:09.473445 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m14:43:09.474067 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m14:43:09.479224 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:09.479484 [debug] [MainThread]: On master: BEGIN
[0m14:43:09.479701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:09.488287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:43:09.488546 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:09.488848 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:43:09.495913 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:43:09.496809 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:09.497425 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:09.497675 [debug] [MainThread]: On master: BEGIN
[0m14:43:09.498741 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:43:09.498994 [debug] [MainThread]: On master: COMMIT
[0m14:43:09.499223 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:09.499441 [debug] [MainThread]: On master: COMMIT
[0m14:43:09.500038 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:43:09.500290 [debug] [MainThread]: On master: Close
[0m14:43:09.501113 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m14:43:09.501593 [info ] [MainThread]: 
[0m14:43:09.505567 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m14:43:09.506177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m14:43:09.506480 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m14:43:09.542863 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m14:43:09.543446 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 14:43:09.506668 => 14:43:09.543211
[0m14:43:09.544190 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m14:43:09.544859 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m14:43:09.545504 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m14:43:09.545821 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m14:43:09.600688 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m14:43:09.601236 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 14:43:09.546052 => 14:43:09.601020
[0m14:43:09.602003 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m14:43:09.602655 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m14:43:09.603320 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m14:43:09.603611 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m14:43:09.675803 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m14:43:09.676420 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 14:43:09.603792 => 14:43:09.676184
[0m14:43:09.677185 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m14:43:09.677899 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m14:43:09.678327 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m14:43:09.679081 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m14:43:09.679368 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m14:43:09.696232 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m14:43:09.696742 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 14:43:09.679546 => 14:43:09.696549
[0m14:43:09.697068 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m14:43:09.730719 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m14:43:09.731198 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:43:09.731535 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m14:43:09.731809 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m14:43:09.741088 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m14:43:09.741405 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:43:09.742009 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "name_suffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "degree_cip_4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "degree_cip_2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "degree_cip_3",
    cast("College Code/Branch" as text) as "college_code_branch",
    cast("First Name" as text) as "first_name",
    cast("College Name" as text) as "college_name",
    cast("Graduated?" as text) as "graduated",
    cast("Degree Title" as text) as "degree_title",
    cast("Enrollment Major 2" as text) as "enrollment_major_2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "degree_cip_1",
    cast("Enrollment Major 1" as text) as "enrollment_major_1",
    cast("Class Level" as text) as "class_level",
    cast("Your Unique Identifier" as text) as "your_unique_identifier",
    cast("Search Date" as 
    bigint
) as "search_date",
    cast("College State" as text) as "college_state",
    cast("Middle Initial" as text) as "middle_initial",
    cast("Enrollment Begin" as DATE ) as "enrollment_begin",
    cast("Enrollment Status" as text) as "enrollment_status",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "enrollment_cip_2",
    cast("Enrollment CIP 1" as 
    float
) as "enrollment_cip_1",
    cast("Degree Major 4" as text) as "degree_major_4",
    cast("Degree Major 3" as text) as "degree_major_3",
    cast("Graduation Date" as 
    float
) as "graduation_date",
    cast("Degree Major 2" as text) as "degree_major_2",
    cast("Degree Major 1" as text) as "degree_major_1",
    cast("Public / Private" as text) as "public_private",
    cast("Enrollment End" as DATE ) as "enrollment_end",
    cast("Last Name" as text) as "last_name",
    cast("2-year / 4-year" as text) as "2-year_4-year",
    cast("Record Found Y/N" as text) as "record_found_yn",
    cast("College Sequence" as 
    float
) as "college_sequence",
    cast("Requester Return Field" as 
    bigint
) as "requester_return_field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("name_suffix" as text), '') || '-' || coalesce(cast("degree_cip_4" as text), '') || '-' || coalesce(cast("degree_cip_2" as text), '') || '-' || coalesce(cast("degree_cip_3" as text), '') || '-' || coalesce(cast("college_code_branch" as text), '') || '-' || coalesce(cast("first_name" as text), '') || '-' || coalesce(cast("college_name" as text), '') || '-' || coalesce(cast("graduated" as text), '') || '-' || coalesce(cast("degree_title" as text), '') || '-' || coalesce(cast("enrollment_major_2" as text), '') || '-' || coalesce(cast("degree_cip_1" as text), '') || '-' || coalesce(cast("enrollment_major_1" as text), '') || '-' || coalesce(cast("class_level" as text), '') || '-' || coalesce(cast("your_unique_identifier" as text), '') || '-' || coalesce(cast("search_date" as text), '') || '-' || coalesce(cast("college_state" as text), '') || '-' || coalesce(cast("middle_initial" as text), '') || '-' || coalesce(cast("enrollment_begin" as text), '') || '-' || coalesce(cast("enrollment_status" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("enrollment_cip_2" as text), '') || '-' || coalesce(cast("enrollment_cip_1" as text), '') || '-' || coalesce(cast("degree_major_4" as text), '') || '-' || coalesce(cast("degree_major_3" as text), '') || '-' || coalesce(cast("graduation_date" as text), '') || '-' || coalesce(cast("degree_major_2" as text), '') || '-' || coalesce(cast("degree_major_1" as text), '') || '-' || coalesce(cast("public_private" as text), '') || '-' || coalesce(cast("enrollment_end" as text), '') || '-' || coalesce(cast("last_name" as text), '') || '-' || coalesce(cast("2-year_4-year" as text), '') || '-' || coalesce(cast("record_found_yn" as text), '') || '-' || coalesce(cast("college_sequence" as text), '') || '-' || coalesce(cast("requester_return_field" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "name_suffix",
    "degree_cip_4",
    "degree_cip_2",
    "degree_cip_3",
    "college_code_branch",
    "first_name",
    "college_name",
    "graduated",
    "degree_title",
    "enrollment_major_2",
    "degree_cip_1",
    "enrollment_major_1",
    "class_level",
    "your_unique_identifier",
    "search_date",
    "college_state",
    "middle_initial",
    "enrollment_begin",
    "enrollment_status",
    last_modified,
    "enrollment_cip_2",
    "enrollment_cip_1",
    "degree_major_4",
    "degree_major_3",
    "graduation_date",
    "degree_major_2",
    "degree_major_1",
    "public_private",
    "enrollment_end",
    "last_name",
    "2-year_4-year",
    "record_found_yn",
    "college_sequence",
    "requester_return_field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m14:43:13.086042 [debug] [Thread-7 (]: SQL status: SELECT 197245 in 3.0 seconds
[0m14:43:13.092850 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:43:13.093400 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging"."public"."nsc" rename to "nsc__dbt_backup"
[0m14:43:13.109413 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:13.112844 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:43:13.113232 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging".public."nsc__dbt_tmp" rename to "nsc"
[0m14:43:13.114175 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:13.124974 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:43:13.125330 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

    create  index if not exists
  "fb1b5250a58b323e2e19bc7d49c37c47"
  on "datahub_staging".public."nsc" using btree
  (_airbyte_emitted_at);
  
[0m14:43:13.214466 [debug] [Thread-7 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m14:43:13.233229 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m14:43:13.233586 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:43:13.233898 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m14:43:13.249980 [debug] [Thread-7 (]: SQL status: COMMIT in 0.0 seconds
[0m14:43:13.255077 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:43:13.255401 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
drop table if exists "datahub_staging".public."nsc__dbt_backup" cascade
[0m14:43:13.267169 [debug] [Thread-7 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:43:13.268571 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 14:43:09.697250 => 14:43:13.268374
[0m14:43:13.268886 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m14:43:13.270087 [info ] [Thread-7 (]: 1 of 1 OK created sql table model public.nsc ........................................................................... [[32mSELECT 197245[0m in 3.59s]
[0m14:43:13.270890 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m14:43:13.272705 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:13.273024 [debug] [MainThread]: On master: BEGIN
[0m14:43:13.273303 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:43:13.282679 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:43:13.282992 [debug] [MainThread]: On master: COMMIT
[0m14:43:13.283233 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:13.283460 [debug] [MainThread]: On master: COMMIT
[0m14:43:13.284027 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:43:13.284286 [debug] [MainThread]: On master: Close
[0m14:43:13.285059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:13.285387 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m14:43:13.285679 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m14:43:13.286040 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m14:43:13.286267 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m14:43:13.286508 [info ] [MainThread]: 
[0m14:43:13.286855 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m14:43:13.287481 [debug] [MainThread]: Command end result
[0m14:43:13.296311 [info ] [MainThread]: 
[0m14:43:13.296701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:13.297037 [info ] [MainThread]: 
[0m14:43:13.297384 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:43:13.297972 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:13.297869 after 4.03 seconds
[0m14:43:13.298261 [debug] [MainThread]: Flushing usage events


============================== 14:46:22.240176 | 79fce208-86a8-465f-95f4-66c771308378 ==============================
[0m14:46:22.240176 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:46:22.242351 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/azureuser/dbt-normalize/nsc/logs', 'profiles_dir': '/home/azureuser/dbt-normalize/nsc', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m14:46:22.268585 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r981lp2z'
[0m14:46:22.269020 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m14:46:22.606337 [debug] [MainThread]: STDOUT: "b''"
[0m14:46:22.606746 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m14:46:22.607125 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m14:46:22.607370 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:46:22.608566 [debug] [MainThread]: STDOUT: "b'e9d23b5c152422d6a294c71199e595f4224ca966\n'"
[0m14:46:22.608804 [debug] [MainThread]: STDERR: "b''"
[0m14:46:22.609022 [debug] [MainThread]: Checking out revision 0.8.2.
[0m14:46:22.609249 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m14:46:22.610600 [debug] [MainThread]: STDOUT: "b''"
[0m14:46:22.610830 [debug] [MainThread]: STDERR: "b''"
[0m14:46:22.611048 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m14:46:22.963376 [debug] [MainThread]: STDOUT: "b''"
[0m14:46:22.963924 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n'"
[0m14:46:22.964307 [debug] [MainThread]: Executing "git tag --list"
[0m14:46:22.965877 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m14:46:22.966139 [debug] [MainThread]: STDERR: "b''"
[0m14:46:22.966374 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m14:46:23.045355 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m14:46:23.045666 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.045948 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:46:23.047109 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:46:23.047346 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.047565 [debug] [MainThread]: Checked out at 5717b10.
[0m14:46:23.048361 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m14:46:23.049401 [debug] [MainThread]: STDOUT: "b''"
[0m14:46:23.049639 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m14:46:23.049890 [debug] [MainThread]: command return code=128
[0m14:46:23.050500 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m14:46:23.050723 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:46:23.051760 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:46:23.051995 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.052205 [debug] [MainThread]: Checking out revision 0.8.2.
[0m14:46:23.052419 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m14:46:23.053870 [debug] [MainThread]: STDOUT: "b''"
[0m14:46:23.054129 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.054354 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m14:46:23.299488 [debug] [MainThread]: STDOUT: "b''"
[0m14:46:23.299894 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m14:46:23.300160 [debug] [MainThread]: Executing "git tag --list"
[0m14:46:23.301664 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m14:46:23.301945 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.302176 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m14:46:23.320084 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m14:46:23.320327 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.320545 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:46:23.321603 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:46:23.321881 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.322105 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m14:46:23.322857 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m14:46:23.328116 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m14:46:23.329139 [debug] [MainThread]: STDOUT: "b''"
[0m14:46:23.329374 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m14:46:23.329578 [debug] [MainThread]: command return code=128
[0m14:46:23.330063 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m14:46:23.330285 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:46:23.331328 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:46:23.331553 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.331760 [debug] [MainThread]: Checking out revision 0.8.2.
[0m14:46:23.331969 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m14:46:23.333216 [debug] [MainThread]: STDOUT: "b''"
[0m14:46:23.333488 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.333703 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m14:46:23.558811 [debug] [MainThread]: STDOUT: "b''"
[0m14:46:23.559213 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m14:46:23.559485 [debug] [MainThread]: Executing "git tag --list"
[0m14:46:23.560962 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n'"
[0m14:46:23.561218 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.561452 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m14:46:23.566966 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m14:46:23.567210 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.567432 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m14:46:23.568477 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m14:46:23.568708 [debug] [MainThread]: STDERR: "b''"
[0m14:46:23.568917 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m14:46:23.569162 [info ] [MainThread]: Installed from revision 0.8.2
[0m14:46:23.569875 [debug] [MainThread]: Command `dbt deps` succeeded at 14:46:23.569763 after 1.34 seconds
[0m14:46:23.570137 [debug] [MainThread]: Flushing usage events


============================== 14:46:25.040424 | 16c6fb1d-e0f9-4383-96fe-87cc1376ec86 ==============================
[0m14:46:25.040424 [info ] [MainThread]: Running with dbt=1.5.0
[0m14:46:25.042581 [debug] [MainThread]: running dbt with arguments {'printer_width': '120', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/azureuser/dbt-normalize/nsc', 'log_path': '/home/azureuser/dbt-normalize/nsc/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m14:46:25.127716 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m14:46:25.163910 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:46:26.097357 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab1.sql
[0m14:46:26.142738 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab1.sql
[0m14:46:26.145480 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab2.sql
[0m14:46:26.181261 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab2.sql
[0m14:46:26.183579 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_ctes/public/nsc_ab3.sql
[0m14:46:26.234362 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_ctes/public/nsc_ab3.sql
[0m14:46:26.236824 [debug] [MainThread]: 1603: static parser failed on generated/airbyte_tables/public/nsc.sql
[0m14:46:26.250329 [debug] [MainThread]: 1602: parser fallback to jinja rendering on generated/airbyte_tables/public/nsc.sql
[0m14:46:26.321446 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.airbyte_utils.generated.airbyte_incremental
- models.airbyte_utils.generated.airbyte_views
[0m14:46:26.334605 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 743 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:46:26.335875 [info ] [MainThread]: 
[0m14:46:26.336604 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:46:26.337504 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging'
[0m14:46:26.346651 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging"
[0m14:46:26.346925 [debug] [ThreadPool]: On list_datahub_staging: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging"} */

    select distinct nspname from pg_namespace
  
[0m14:46:26.347153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:26.357858 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:46:26.358889 [debug] [ThreadPool]: On list_datahub_staging: Close
[0m14:46:26.360644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_datahub_staging_public'
[0m14:46:26.366039 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m14:46:26.366298 [debug] [ThreadPool]: On list_datahub_staging_public: BEGIN
[0m14:46:26.366518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:26.375311 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:46:26.375568 [debug] [ThreadPool]: Using postgres connection "list_datahub_staging_public"
[0m14:46:26.375811 [debug] [ThreadPool]: On list_datahub_staging_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "list_datahub_staging_public"} */
select
      'datahub_staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datahub_staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:46:26.377976 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:46:26.378964 [debug] [ThreadPool]: On list_datahub_staging_public: ROLLBACK
[0m14:46:26.379665 [debug] [ThreadPool]: On list_datahub_staging_public: Close
[0m14:46:26.385778 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:26.386039 [debug] [MainThread]: On master: BEGIN
[0m14:46:26.386256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:46:26.395207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:46:26.395477 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:26.395778 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:46:26.402656 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:46:26.403576 [debug] [MainThread]: On master: ROLLBACK
[0m14:46:26.404220 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:26.404465 [debug] [MainThread]: On master: BEGIN
[0m14:46:26.405418 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:46:26.405687 [debug] [MainThread]: On master: COMMIT
[0m14:46:26.405949 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:26.406162 [debug] [MainThread]: On master: COMMIT
[0m14:46:26.406860 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:46:26.407106 [debug] [MainThread]: On master: Close
[0m14:46:26.407987 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m14:46:26.408529 [info ] [MainThread]: 
[0m14:46:26.411882 [debug] [Thread-1 (]: Began running node model.airbyte_utils.nsc_ab1
[0m14:46:26.412576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datahub_staging_public, now model.airbyte_utils.nsc_ab1)
[0m14:46:26.412873 [debug] [Thread-1 (]: Began compiling node model.airbyte_utils.nsc_ab1
[0m14:46:26.442897 [debug] [Thread-1 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab1"
[0m14:46:26.443484 [debug] [Thread-1 (]: Timing info for model.airbyte_utils.nsc_ab1 (compile): 14:46:26.413060 => 14:46:26.443247
[0m14:46:26.444241 [debug] [Thread-1 (]: Finished running node model.airbyte_utils.nsc_ab1
[0m14:46:26.444943 [debug] [Thread-3 (]: Began running node model.airbyte_utils.nsc_ab2
[0m14:46:26.445601 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab2'
[0m14:46:26.445931 [debug] [Thread-3 (]: Began compiling node model.airbyte_utils.nsc_ab2
[0m14:46:26.492465 [debug] [Thread-3 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab2"
[0m14:46:26.492998 [debug] [Thread-3 (]: Timing info for model.airbyte_utils.nsc_ab2 (compile): 14:46:26.446113 => 14:46:26.492772
[0m14:46:26.493790 [debug] [Thread-3 (]: Finished running node model.airbyte_utils.nsc_ab2
[0m14:46:26.494423 [debug] [Thread-5 (]: Began running node model.airbyte_utils.nsc_ab3
[0m14:46:26.495091 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc_ab3'
[0m14:46:26.495411 [debug] [Thread-5 (]: Began compiling node model.airbyte_utils.nsc_ab3
[0m14:46:26.555347 [debug] [Thread-5 (]: Writing injected SQL for node "model.airbyte_utils.nsc_ab3"
[0m14:46:26.555874 [debug] [Thread-5 (]: Timing info for model.airbyte_utils.nsc_ab3 (compile): 14:46:26.495623 => 14:46:26.555653
[0m14:46:26.556599 [debug] [Thread-5 (]: Finished running node model.airbyte_utils.nsc_ab3
[0m14:46:26.557249 [debug] [Thread-7 (]: Began running node model.airbyte_utils.nsc
[0m14:46:26.557645 [info ] [Thread-7 (]: 1 of 1 START sql table model public.nsc ................................................................................ [RUN]
[0m14:46:26.558386 [debug] [Thread-7 (]: Acquiring new postgres connection 'model.airbyte_utils.nsc'
[0m14:46:26.558670 [debug] [Thread-7 (]: Began compiling node model.airbyte_utils.nsc
[0m14:46:26.575392 [debug] [Thread-7 (]: Writing injected SQL for node "model.airbyte_utils.nsc"
[0m14:46:26.575919 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (compile): 14:46:26.558842 => 14:46:26.575705
[0m14:46:26.576223 [debug] [Thread-7 (]: Began executing node model.airbyte_utils.nsc
[0m14:46:26.609957 [debug] [Thread-7 (]: Writing runtime sql for node "model.airbyte_utils.nsc"
[0m14:46:26.610447 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:46:26.610746 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: BEGIN
[0m14:46:26.611011 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m14:46:26.619975 [debug] [Thread-7 (]: SQL status: BEGIN in 0.0 seconds
[0m14:46:26.620288 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:46:26.620849 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

  
    

  create  table "datahub_staging".public."nsc__dbt_tmp"
  
  
    as
  
  (
    
with __dbt__cte__nsc_ab1 as (

-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "datahub_staging".public._airbyte_raw_nsc
select
    jsonb_extract_path_text(_airbyte_data, 'Name Suffix') as "Name Suffix",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 4') as "Degree CIP 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 2') as "Degree CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 3') as "Degree CIP 3",
    jsonb_extract_path_text(_airbyte_data, 'College Code/Branch') as "College Code/Branch",
    jsonb_extract_path_text(_airbyte_data, 'First Name') as "First Name",
    jsonb_extract_path_text(_airbyte_data, 'College Name') as "College Name",
    jsonb_extract_path_text(_airbyte_data, 'Graduated?') as "Graduated?",
    jsonb_extract_path_text(_airbyte_data, 'Degree Title') as "Degree Title",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 2') as "Enrollment Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree CIP 1') as "Degree CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Major 1') as "Enrollment Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Class Level') as "Class Level",
    jsonb_extract_path_text(_airbyte_data, 'Your Unique Identifier') as "Your Unique Identifier",
    jsonb_extract_path_text(_airbyte_data, 'Search Date') as "Search Date",
    jsonb_extract_path_text(_airbyte_data, 'College State') as "College State",
    jsonb_extract_path_text(_airbyte_data, 'Middle Initial') as "Middle Initial",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Begin') as "Enrollment Begin",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment Status') as "Enrollment Status",
    jsonb_extract_path_text(_airbyte_data, 'last_modified') as last_modified,
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 2') as "Enrollment CIP 2",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment CIP 1') as "Enrollment CIP 1",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 4') as "Degree Major 4",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 3') as "Degree Major 3",
    jsonb_extract_path_text(_airbyte_data, 'Graduation Date') as "Graduation Date",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 2') as "Degree Major 2",
    jsonb_extract_path_text(_airbyte_data, 'Degree Major 1') as "Degree Major 1",
    jsonb_extract_path_text(_airbyte_data, 'Public / Private') as "Public / Private",
    jsonb_extract_path_text(_airbyte_data, 'Enrollment End') as "Enrollment End",
    jsonb_extract_path_text(_airbyte_data, 'Last Name') as "Last Name",
    jsonb_extract_path_text(_airbyte_data, '2-year / 4-year') as "2-year / 4-year",
    jsonb_extract_path_text(_airbyte_data, 'Record Found Y/N') as "Record Found Y/N",
    jsonb_extract_path_text(_airbyte_data, 'College Sequence') as "College Sequence",
    jsonb_extract_path_text(_airbyte_data, 'Requester Return Field') as "Requester Return Field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "datahub_staging".public._airbyte_raw_nsc as table_alias
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab2 as (

-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: __dbt__cte__nsc_ab1
select
    cast("Name Suffix" as text) as "name_suffix",
    cast("Degree CIP 4" as 
    numeric(28, 6)
) as "degree_cip_4",
    cast("Degree CIP 2" as 
    numeric(28, 6)
) as "degree_cip_2",
    cast("Degree CIP 3" as 
    numeric(28, 6)
) as "degree_cip_3",
    cast("College Code/Branch" as text) as "college_code_branch",
    cast("First Name" as text) as "first_name",
    cast("College Name" as text) as "college_name",
    cast("Graduated?" as text) as "graduated",
    cast("Degree Title" as text) as "degree_title",
    cast("Enrollment Major 2" as text) as "enrollment_major_2",
    cast("Degree CIP 1" as 
    numeric(28, 6)
) as "degree_cip_1",
    cast("Enrollment Major 1" as text) as "enrollment_major_1",
    cast("Class Level" as text) as "class_level",
    cast("Your Unique Identifier" as text) as "your_unique_identifier",
    cast("Search Date" as 
    bigint
) as "search_date",
    cast("College State" as text) as "college_state",
    cast("Middle Initial" as text) as "middle_initial",
    cast("Enrollment Begin" as DATE ) as "enrollment_begin",
    cast("Enrollment Status" as text) as "enrollment_status",
    cast(nullif(last_modified, '') as 
    timestamp with time zone
) as last_modified,
    cast("Enrollment CIP 2" as 
    float
) as "enrollment_cip_2",
    cast("Enrollment CIP 1" as 
    float
) as "enrollment_cip_1",
    cast("Degree Major 4" as text) as "degree_major_4",
    cast("Degree Major 3" as text) as "degree_major_3",
    cast("Graduation Date" as 
    float
) as "graduation_date",
    cast("Degree Major 2" as text) as "degree_major_2",
    cast("Degree Major 1" as text) as "degree_major_1",
    cast("Public / Private" as text) as "public_private",
    cast("Enrollment End" as DATE ) as "enrollment_end",
    cast("Last Name" as text) as "last_name",
    cast("2-year / 4-year" as text) as "2-year_4-year",
    cast("Record Found Y/N" as text) as "record_found_yn",
    cast("College Sequence" as 
    float
) as "college_sequence",
    cast("Requester Return Field" as 
    bigint
) as "requester_return_field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from __dbt__cte__nsc_ab1
-- nsc
where 1 = 1
),  __dbt__cte__nsc_ab3 as (

-- SQL model to build a hash column based on the values of this record
-- depends_on: __dbt__cte__nsc_ab2
select
    md5(cast(coalesce(cast("name_suffix" as text), '') || '-' || coalesce(cast("degree_cip_4" as text), '') || '-' || coalesce(cast("degree_cip_2" as text), '') || '-' || coalesce(cast("degree_cip_3" as text), '') || '-' || coalesce(cast("college_code_branch" as text), '') || '-' || coalesce(cast("first_name" as text), '') || '-' || coalesce(cast("college_name" as text), '') || '-' || coalesce(cast("graduated" as text), '') || '-' || coalesce(cast("degree_title" as text), '') || '-' || coalesce(cast("enrollment_major_2" as text), '') || '-' || coalesce(cast("degree_cip_1" as text), '') || '-' || coalesce(cast("enrollment_major_1" as text), '') || '-' || coalesce(cast("class_level" as text), '') || '-' || coalesce(cast("your_unique_identifier" as text), '') || '-' || coalesce(cast("search_date" as text), '') || '-' || coalesce(cast("college_state" as text), '') || '-' || coalesce(cast("middle_initial" as text), '') || '-' || coalesce(cast("enrollment_begin" as text), '') || '-' || coalesce(cast("enrollment_status" as text), '') || '-' || coalesce(cast(last_modified as text), '') || '-' || coalesce(cast("enrollment_cip_2" as text), '') || '-' || coalesce(cast("enrollment_cip_1" as text), '') || '-' || coalesce(cast("degree_major_4" as text), '') || '-' || coalesce(cast("degree_major_3" as text), '') || '-' || coalesce(cast("graduation_date" as text), '') || '-' || coalesce(cast("degree_major_2" as text), '') || '-' || coalesce(cast("degree_major_1" as text), '') || '-' || coalesce(cast("public_private" as text), '') || '-' || coalesce(cast("enrollment_end" as text), '') || '-' || coalesce(cast("last_name" as text), '') || '-' || coalesce(cast("2-year_4-year" as text), '') || '-' || coalesce(cast("record_found_yn" as text), '') || '-' || coalesce(cast("college_sequence" as text), '') || '-' || coalesce(cast("requester_return_field" as text), '') as text)) as _airbyte_nsc_hashid,
    tmp.*
from __dbt__cte__nsc_ab2 tmp
-- nsc
where 1 = 1
)-- Final base SQL model
-- depends_on: __dbt__cte__nsc_ab3
select
    "name_suffix",
    "degree_cip_4",
    "degree_cip_2",
    "degree_cip_3",
    "college_code_branch",
    "first_name",
    "college_name",
    "graduated",
    "degree_title",
    "enrollment_major_2",
    "degree_cip_1",
    "enrollment_major_1",
    "class_level",
    "your_unique_identifier",
    "search_date",
    "college_state",
    "middle_initial",
    "enrollment_begin",
    "enrollment_status",
    last_modified,
    "enrollment_cip_2",
    "enrollment_cip_1",
    "degree_major_4",
    "degree_major_3",
    "graduation_date",
    "degree_major_2",
    "degree_major_1",
    "public_private",
    "enrollment_end",
    "last_name",
    "2-year_4-year",
    "record_found_yn",
    "college_sequence",
    "requester_return_field",
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_nsc_hashid
from __dbt__cte__nsc_ab3
-- nsc from "datahub_staging".public._airbyte_raw_nsc
where 1 = 1
  );
  
[0m14:46:30.020644 [debug] [Thread-7 (]: SQL status: SELECT 197245 in 3.0 seconds
[0m14:46:30.027147 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:46:30.027479 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging"."public"."nsc" rename to "nsc__dbt_backup"
[0m14:46:30.028379 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:30.031330 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:46:30.031641 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
alter table "datahub_staging".public."nsc__dbt_tmp" rename to "nsc"
[0m14:46:30.032480 [debug] [Thread-7 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:46:30.043750 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:46:30.044075 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */

    create  index if not exists
  "d394761a8fc1a5a211e197a8e0237447"
  on "datahub_staging".public."nsc" using btree
  (_airbyte_emitted_at);
  
[0m14:46:30.133918 [debug] [Thread-7 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m14:46:30.151759 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m14:46:30.152108 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:46:30.152384 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: COMMIT
[0m14:46:30.164649 [debug] [Thread-7 (]: SQL status: COMMIT in 0.0 seconds
[0m14:46:30.169842 [debug] [Thread-7 (]: Using postgres connection "model.airbyte_utils.nsc"
[0m14:46:30.170161 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "normalize", "target_name": "prod", "node_id": "model.airbyte_utils.nsc"} */
drop table if exists "datahub_staging".public."nsc__dbt_backup" cascade
[0m14:46:30.180040 [debug] [Thread-7 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:46:30.181336 [debug] [Thread-7 (]: Timing info for model.airbyte_utils.nsc (execute): 14:46:26.576404 => 14:46:30.181150
[0m14:46:30.181640 [debug] [Thread-7 (]: On model.airbyte_utils.nsc: Close
[0m14:46:30.182827 [info ] [Thread-7 (]: 1 of 1 OK created sql table model public.nsc ........................................................................... [[32mSELECT 197245[0m in 3.62s]
[0m14:46:30.183629 [debug] [Thread-7 (]: Finished running node model.airbyte_utils.nsc
[0m14:46:30.185591 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:30.185928 [debug] [MainThread]: On master: BEGIN
[0m14:46:30.186223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:46:30.195577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:46:30.195853 [debug] [MainThread]: On master: COMMIT
[0m14:46:30.196086 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:30.196302 [debug] [MainThread]: On master: COMMIT
[0m14:46:30.196907 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:46:30.197161 [debug] [MainThread]: On master: Close
[0m14:46:30.197984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:30.198307 [debug] [MainThread]: Connection 'list_datahub_staging' was properly closed.
[0m14:46:30.198600 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab1' was properly closed.
[0m14:46:30.198876 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab2' was properly closed.
[0m14:46:30.199125 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc_ab3' was properly closed.
[0m14:46:30.199318 [debug] [MainThread]: Connection 'model.airbyte_utils.nsc' was properly closed.
[0m14:46:30.199554 [info ] [MainThread]: 
[0m14:46:30.199900 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m14:46:30.200488 [debug] [MainThread]: Command end result
[0m14:46:30.210130 [info ] [MainThread]: 
[0m14:46:30.210533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:46:30.210875 [info ] [MainThread]: 
[0m14:46:30.211219 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:46:30.211784 [debug] [MainThread]: Command `dbt run` succeeded at 14:46:30.211674 after 5.18 seconds
[0m14:46:30.212042 [debug] [MainThread]: Flushing usage events
